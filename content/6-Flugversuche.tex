\chapter[Flugversuche]{Verifizierung der Positionsregelung am realen System}
\label{chap:Flugversuche}
Nach dem die Funktionsfähigkeit der von \gls{asctec} und ETH-Zürich entworfenen Positionsregelung mittels Herleitung der einzelnen Komponenten sowie einer abschließenden Simulation des Gesamtsystems (Kapitel \ref{sec:sim_posreg}) in der Theorie bewiesen ist, fokussiert sich diese Kapitel \ref{chap:Flugversuche} auf die Verifizierung der Regelung am realen System. So gilt es zu darauf zu achten ob die Zeitkonstante der Lagerregelung, die in der Modellbildung vernachlässigt worden ist, eine Auswirkung auf die Positionsregelung hat. Ausweisen wird sich ob die Positionsbestimmung mittels eines Lasers anhand der in Kapitel \ref{chap:2Dpositionsbestimmung} beschrieben orthogonalen Projektion sowie das scanmatching-Verfahren anwendbar ist. 

Dafür wird in Kapitel \ref{sec:anflugKoor} eine Messung untersucht, bei der der Positionsregelung eine neue Koordinate übergeben wird, in die der Quadrocopter überführt werden soll. Im anschließend Kapitel \ref{sec:geschwReg} wird bezugnehmend auf das ursprüngliche Thema der Arbeit, der Geschwindigkeitsregelung des Quadrocopter, die Funktionsfähigkeit der Positionsregelung als eben diese Geschwindigkeitsregelung dargelegt.



\section{Anflug einer Koordinate im Raum}
Um die Messergebnisse mit denn der Simulation in Kapitel \ref{sec:sim_posreg} vergleichbar zu gestalten, entspricht die Ausgangskoordinate ($ x = 0$, $y = 0 $) als auch die Zielkoordinate ($ x = -2$, $y = 1 $) denen des Simulationsbeispieles. Des Weiteren stimmen die Parameter es Beobachter ($ L= \begin{bmatrix} 18 & 46 & 3.75 \end{bmatrix}^T $) sowie die der Positionsregelung ($ \tilde{c}_1 = 4 $, $ \tilde{c}_0 = 5 $, $ \tilde{c}_1 = 0.01 $) mit der in der Simulation verwendeten Parametrierung überein. Zusätzlich erfolgte auch hier die Ausrichtung des Quadrocopters so, dass die Orientierung des o-frames über den Zeitraum der Messung mit dem n-frame übereinstimmt ($ \psi = 0 $). Damit ist hier ebenfalls die Achsenbewegung einem bestimmten Neigungswinkel zuzuordnen.   
\label{sec:anflugKoor}
 \begin{figure}
 	\centering
 	\includegraphics[width = .75 \textwidth]{images/real_xy}
 	\caption[Positionsverschiebung des Quadrocopters]{Positionsverschiebung des Quadrocopters} %
 	\label{fig:real_xy}
 \end{figure}
 
 Betrachtet man zunächst den Verlauf des Referenzpfades in Abbildung \ref{fig:real_xy} und vergleicht diesen mit dem in der Abbildung \ref{fig:gessim_xy} dargestellten der Simulation, fällt auf, das diese nicht den gleichen Verlauf aufzeigen. Erklären lässt sich das damit, das es bei dem auf dem \gls{hlp} realisierte Referenzmodell nicht eins zu eins um den die in Paper \cite{Achtelik11} als auch in Kapitel \ref{sec:referenzmodell} vorgestellte Vorsteuerung handelt. Präziser ausgedrückt deutet das Messergebnis darauf hin, das die Vorsteuerung eine Trajektorie mit einer höheren Stetigkeitsbedingung generiert \cite{mzr13}. Das bedeutet der vorgegebene Pfad ist zweimal stetig differenzierbar und nicht nur einmal sowie in Kapitel \ref{sec:referenzmodell} beschrieben. Zur Folge hat dies, dass der gewünschte Beschleunigungsverlauf und damit verbunden Vorgabe der Neigunswinkel stetig ist, d.h. keine spunghaften Änderungen gefordert werden. Bestätigt wird diese Annahme, wenn man den Verlauf der vorgegeben Neigungswinkel in Abbildung \ref{fig:real} mit den Winkel der Simulation (Abbildung \ref{fig:gessim}) vergleicht. 
 
 Untersucht wird jetzt die Flugbahn des Quadrocopter anhand der vom Beobachter geschätzten Positionsdaten in Abbildung \ref{fig:real_xy}. Zu erkennen ist, dass die Position des Quadrocopter ausgehend von einer inkonsistente Anfangsbedingung dank des Folgereglers zu Beginn mit der Referenztrajektorie konvergiert. Ab der Koordinate $ x = -1 $ und $ y = 0.75 $ entfernt sich jedoch der Quadrocopter von dem vorgegebenen Pfad bevor er schließlich über der Zielposition einschwingt. Um zu ergründen warum die Position des Flugsystems plötzlich vom Referenzpfad divergiert ist der zeitliche Verlauf der Zustände für jede Achse zu untersuchen (\ref{fig:real}). Dabei lässt sich anhand Abbildung \ref{fig:real_x} und Abbildung \ref{fig:real_y} erkennen, das kurz bevor der Quadrocopter den Referenzpfad schneidet, für circa eine Sekunde keine Positionspdates vom Laser zu Verfügung stehen. Dies hat zur Folge das der Schätzwert des Beobachters auf der letzten bekannten Position verharrt, ob wohl sich in Wirklichkeit der Quadrocopter weiter bewegt. Die Folge, die Differenz zwischen ist und soll Position steigt, obwohl dies nicht der Realität entspricht. Gleichzeitig sinkt auch der Betrag die geschätzte Geschwindigkeit, zu sehen in Abbildung \ref{fig:gessim_vel_x}, bzw. für die y-Achse in Abbildung \ref{fig:gessim_vel_y}. Das Ergebnis der Zustandsfolgeregler sorgt dafür, das der Betrag der Neigungswinkel erhöht wird und somit der Quadrocopter fälschlicher Weise weiter beschleunigt und sich dessen Geschwindigkeit erhöht. Der Grund warum der Quadrocopter plötzlich  vom Referenzpfad divergiert (Abbildung \ref{fig:gessim_xy}). Nach dieser einen Sekunde ohne Positionsupdate wird die Position wieder zuverlässig über den Laser bestimmt. Der Beobachter schätzt nun die zu hohe Geschwindigkeit mit der sich der Quadrocopter tatsächlich bewegt (Abbildung \ref{fig:gessim_vel_x} und Abbildung \ref{fig:gessim_vel_y}). Da jetzt Position und Geschwindigkeit deutlich von den Vorgaben des Referenzmodells abweichen, fordert der Folgeregeler in Verbindung mit der Inversion entgegengesetzte Neigungswinkel um den Quadrocopter abzubremsen und zurück auf die gewünschte Flugbahn zu führen. In Abbildung \ref{fig:real_theta} und Abbildung \ref{fig:real_phi} ist zu erkennen, das der Betrag dieser Winkel deutlich über den zuvor geforderten liegt.  Da die Lageregelung die vorgegebenen Winkel nahezu ohne Zeitverzögerung einstellt, erfolgt somit die Bremsung bzw. die Richtungsänderung hin zur Referenztrajektorie sehr abrupt. Klar zu erkennen ist die zackige Bewegung in Abbildung \ref{fig:real_xy} kurz vor erreichen der Zielkoordinate. Der Quadrocopter überfliegt dabei zwar nochmal den Referenzpfad, schwingt allerdings aufgrund de stabilisierenden Auslegung des Folgereglers und den nun kontinuierlich vorhanden Positionsdaten in einer Umgebung $ \pm 10~cm $ um die Endposition ein. Womit bewiesen ist, das die Positionsregelung mittels eines Lasersanners möglich ist.
 \begin{figure}
 	
 	\centering{
 		\subfloat[Position x-Achse]{
 			\includegraphics[width=0.5\textwidth]{images/real_x}
 			\label{fig:real_x}
 		}
 		\subfloat[Position y-Achse]{
 			\includegraphics[width=0.5\textwidth]{images/real_y}
 			\label{fig:real_y}
 		}\\
 		\subfloat[Geschwindigkeit x-Achse]{
 			\includegraphics[width=0.5\textwidth]{images/real_vx}
 			\label{fig:real_vx}
 		}
 		\subfloat[Geschwindigkeit y-Achse]{
 			\includegraphics[width=0.5\textwidth]{images/real_vy}
 			\label{fig:real_vy}
 		}\\
 		\subfloat[Nickwinkel]{
 			\includegraphics[width=0.5\textwidth]{images/real_theta}
 			\label{fig:real_theta}
 		}
 		\subfloat[Rollwinkel]{
 			\includegraphics[width=0.5\textwidth]{images/real_phi}
 			\label{fig:real_phi}
 		}
 	}	
 	\caption[Messergebnisse Flug]{Messergebnisse Flug}
 	\label{fig:real}
 \end{figure}
 
 Rein Optisch wirkte das Regelverhalten dieser Messung von außen sehr nervös, da ohne Kenntnis der Messdaten kein ersichtlicher Grund für die großen Stellwinkel zu erkennen war. Des Weiteren treten solche Definitionslücken bei der Lokalisierung nur sporadisch auf, so dass der Quadrocopter in den meisten Fällen in einer flüssigen Bewegung in die neun Position überführt wird. Nichtsdestotrotz gilt es den Einfluss der Lücken in der Positionsbestimmung zu minimieren, da vor allem bei längeren Flügen die Wahrscheinlichkeit das ein solcher Fehler auftritt steigt. So gilt es im Anschluss dieser Masterthesis zu untersuchen, welche Umstände eine lückenhaften Lokalisierung mittels Laser führen. Möglich ist, dass das von \gls{ros} verwendete IP-Protokoll zeitweise zu viele Umgebungsscans in einem Datenpaket zusammenfasst womit die physische Abtastrate reduziert wird. Alternative könnte die Ursache darin liegen, das der Laser für zu große Neigungswinkel den Boden bzw. die Decke erfasst, somit der ICP-Algorithmus (Kapitel \ref{sec:laser_scan_matching}) die aufeinanderfolgenden Scans nicht übereinander legen kann und damit zu keinen Positionsergebnis kommt. Wäre dem so, bestände die Möglichkeit die maximalen Stellwinkel zu begrenzen. Dies würde jedoch zu einer Beschränkung der Dynamik führen. Deshalb wäre in dem Fall zu untersuchen, ob ein 3D-SLAM-Algorithmus, zur Positionsbestimmung nicht die besser Alternative darstellt. Vorraussetzung dafür ist jedoch eine genaue Höhenbestimmung des Quadrocopters. Diese wurde zwar von Jan Kallwies \cite{JanKal13} entwickelt wurde, steht momentan allerdings nicht auf dem Quadrocopter zur Verfügung. So wäre eine kurzfristige Lösung zur Bekämpfung des Einfluss von Lokalisierungslücken, die Implementierung eines Algorithmus der ausbleibende Positionsdaten zuverlässig erkennt. Schlägt dieser Algorithmus an, könnte die zu lässigen Neigungswinkel auf ein Minimum reduzieren werden, sodass der Quadrocopter nicht weiter beschleunigt. Nach erhalten neuer Positionsdaten ist diese Limitierung aufzuheben.  
 
 
 Schlussendlich ist auch ohne diese Maßnahmen die Funktionsfähigkeit der von AscTec in Verbindung mit der ETH-Zürich entwickelten Positionsregelung bewiesen. Zum Abschluss gilt es noch die Anwendbarkeit der Positionsregelung als Geschwindigkeitsregler, mittels Fernsteuerung aufzuzeigen.      
 


 
    
 


\section{Geschwindigkeitsregelung }
\label{sec:geschwReg}

 \begin{figure}
 	
 	\centering{
 		\subfloat[Geschwindigkeit in Richtung x des o-frames]{
 			\includegraphics[width=0.5\textwidth]{images/vel_vxof}
 			\label{fig:vel_vxof}
 		}
 		\subfloat[Geschwindigkeit in Richtung y des o-frames]{
 			\includegraphics[width=0.5\textwidth]{images/vel_vyof}
 			\label{fig:vel_vyof}
 		}\\
 		\subfloat[Fernsteuerung Nick-Hebel]{
 			\includegraphics[width=0.5\textwidth]{images/vel_nickheb}
 			\label{fig:vel_nickheb}
 		}
 		\subfloat[Fernsteuerung Roll-Hebel]{
 			\includegraphics[width=0.5\textwidth]{images/vel_rollheb}
 			\label{fig:vel_rollheb}
 		}
 	}	
 	\caption[Messergebnisse Geschwindigkeitsregelung]{Messergebnisse Geschwindigkeitsregelung}
 	\label{fig:velof}
 \end{figure}



 