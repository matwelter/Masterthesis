\chapter[Positionsregelung]{Verifizierung der Positionsregelung der ETH-Zürich in Verbindung mit einem Laserscanner}
\label{chap:Positionsregelung}
\begin{figure}
	\centering
	\includegraphics[width = .95\textwidth]{images/ros_hl_interf_hl_frame}
	\caption[AscTec\_hl\_framework in der Kommunikationstruktur]{AscTec\_hl\_framework in der Kommunikationstruktur }
	\label{fig:asctechlfrkom}
\end{figure}

In einer Zusammenarbeit von \gls{asctec} und der ETH-Zürich \DIFdelbegin \DIFdel{wurde eine }\DIFdelend \DIFaddbegin \DIFadd{ist ein }\DIFaddend Regler zur Positionierung des Pelican Quadrocopters in geschlossenen Räumen \DIFdelbegin \DIFdel{entworfen }\DIFdelend \DIFaddbegin \DIFadd{entwickelt }\DIFaddend und veröffentlicht. Der Entwurf basierte \DIFdelbegin \DIFdel{dabei }\DIFdelend auf einer monokularen Kamera\DIFdelbegin \DIFdel{über }\DIFdelend \DIFaddbegin \DIFadd{, }\DIFaddend die mittels eines \gls{vslam}-Algorithmus und der Fusion der \gls{imu} die Position des Flugobjekts in \DIFdelbegin \DIFdel{der unbekannten Umgebung ermittelt wird}\DIFdelend \DIFaddbegin \DIFadd{einer unbekannten Umgebung ermitteln kann}\DIFaddend . Die dazugehörigen Regelung- und Fusionsalgortihmus sind im Paper \cite{Achtelik11} beschrieben. Außerdem stehen diese als asctec\_framework zum Download zur Verfügung und \DIFdelbegin \DIFdel{wurden }\DIFdelend \DIFaddbegin \DIFadd{sind }\DIFaddend im Rahmen dieser Arbeit auf den \gls{hlp} geladen (Abbildung \ref{fig:asctechlfrkom}).

Aufgabe dieses Kapitel ist es\DIFaddbegin \DIFadd{, }\DIFaddend die veröffentlichen Annahmen und Formel der Fusion und Regelung zu verifizieren. Dies erfolgt über Literaturrecherchen und Herleitung der publizierten Gleichungen. Unter Berücksichtigung, \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{dass }\DIFaddend die Position nun mehr vom Laser über die Kapitel \ref{chap:2Dpositionsbestimmung} vorgestellten Algortihmen bestimmt wird, ist Abschnitt \ref{sec:strukpositionsregelung} darauf ausgelegt eine Übersicht über die Bestandteile der Regelung zu geben. Herleitung der Komponenten erfolgt in den \DIFdelbegin \DIFdel{anschließend }\DIFdelend \DIFaddbegin \DIFadd{anschließenden }\DIFaddend Unterkapiteln. 


%*************************************************************************************************************************
\section{Struktur der Positionsregelung}
\label{sec:strukpositionsregelung}
Das Hauptaugenmerk \DIFdelbegin \DIFdel{diese }\DIFdelend \DIFaddbegin \DIFadd{dieses }\DIFaddend Unterkapitel liegt darauf, wie sich die Positionsregelung in die in Kapitel \ref{sec:Kommunikationsarchitekur} vorgestellte Systemstruktur einfügt. Welche Softwarekomponenten dafür auf dem \gls{hlp} integriert \DIFdelbegin \DIFdel{wurden}\DIFdelend \DIFaddbegin \DIFadd{sind}\DIFaddend . Wie die Kommunikation zwischen ihnen und der Umgebung aussieht. Mit dem Ziel ein grundlegendes Verständnis für die Funktionsweise der Regelung zu generieren.\\
\begin{figure}
	\centering
	\includegraphics[width = .95\textwidth]{images/Kaskadenstruktur}
	\caption[Kaskadenstruktur]{Kaskadenstruktur der vereinfachten Positionsregelung } %
	\label{fig:kaskstruc}
\end{figure}


Die Positionsregelung wird auf die Lageregelung (engl. Attitudecontrol) aufgesetzt. Daraus resultiert eine Kaskadenstruktur (Abbildung \ref{fig:kaskstruc}). Diese Vorgehensweise ist nachvollziehbar, da die Lageregelung bereits \DIFdelbegin \DIFdel{Fest }\DIFdelend \DIFaddbegin \DIFadd{fest }\DIFaddend auf dem \gls{llp} implementiert ist. Diese besteht aus einem Regelalgorithmus\DIFaddbegin \DIFadd{, }\DIFaddend der anhand der Regeldifferenz der Orientierung $e_{ori}$ \DIFdelbegin \DIFdel{, }\DIFdelend \DIFaddbegin \DIFadd{und }\DIFaddend resultierend aus der Abweichung Soll-Orientierung $O_{des}$ \DIFdelbegin \DIFdel{und }\DIFdelend \DIFaddbegin \DIFadd{zu }\DIFaddend Ist-Orientierung $ O  $, in Verbindung mit der Sollschubvorgabe $ T_s $ die Drehzahlen $ n_{1..4} $ der Rotoren berechnet und einstellt. Die Ist-Orientierung $ O =\begin{bmatrix} \phi&\theta&\psi\end{bmatrix}^T $ wird mittels eines Fusionsfilter bestimmt. Dieser fusioniert die Messwerte der auf der \gls{imu} befindlichen Gyroscope mit den Daten des 3D-Kompass. Wie dieser unterlagerte Regler und der dazugehörige Zustandsschätzer genau \DIFdelbegin \DIFdel{ausgeführt sind}\DIFdelend \DIFaddbegin \DIFadd{umgesetzt sind, }\DIFaddend ist nicht bekannt. Eine mögliche Ausführung ist in Paper \cite{hoffmann10} beschrieben. Die Ungewissheit über den Regleraufbau der Lageregelung stellt für den Entwurf der überlagerten Positionsregelung \DIFdelbegin \DIFdel{kein Problem }\DIFdelend \DIFaddbegin \DIFadd{keine Problematik }\DIFaddend dar. Von Interesse ist lediglich, \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{dass }\DIFaddend die Annahme einer sehr hohen Dynamik dieses Reglers zur einer Vereinfachung des für die Positionsregelung benötigen Modells (Kapitel \ref{sec:Modelbildung}) führt. Hohe Dynamik bedeutet, \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{dass }\DIFaddend der Sollwinkel in einer sehr kurzen Zeit $ t \rightarrow 0~s $ erreicht wird. Basierend auf einer \DIFdelbegin \DIFdel{Exakten }\DIFdelend \DIFaddbegin \DIFadd{exakten }\DIFaddend Ein-/Ausgangslinearisierung der inneren Schleife (Kapitel \ref{sec:exkt.ealin}) \DIFdelbegin \DIFdel{, }\DIFdelend ist die äußere Reglerschleife zur Positionsregelung auf dem \gls{hlp} realisiert. Dank der Inversion, realisiert \DIFaddbegin \DIFadd{in einer }\DIFaddend Ein-/Ausgangslinearisierung, kann für die Positionierung des Quadrocopters eine \DIFdelbegin \DIFdel{linerare }\DIFdelend \DIFaddbegin \DIFadd{lineare }\DIFaddend zwei Freiheitsgrade Regelung angewandt werden.
\begin{figure}
	\centering
	\includegraphics[width = .95\textwidth]{images/2-FHG-R}
	\caption[Gesamtstruktur Regelung]{Struktur zwei Freiheitsgraderegelung} %
	\label{fig:zweifgr}
\end{figure} Diese besteht aus einer Vorsteuerung und einem Folgeregler. Die Vorsteuerung auf dem \gls{hlp} ist in Form eines Referenzmodell (Kapitel \ref{sec:referenzmodell}), das \DIFdelbegin \DIFdel{dem }\DIFdelend \DIFaddbegin \DIFadd{der }\DIFaddend Ein-/Ausgangslinearisierung nachempfunden ist, ausgeführt. Anhand der vorgegebenen Soll-Position $P^n_{des} = \begin{bmatrix} x&y&z\end{bmatrix}^T_{des} $ wird eine Referenz-Trajektorie \footnote{Trajektorien beschreiben einen zeitabhängigen Verlauf eines Wertes in einem Bezugssystem} zur Überführung des Quadrocopters aus der aktuellen Ist-Position in die Soll-Position berechnet. Ergebnis ist ein Stellwert für die Inversion, der unter theoretischer Betrachtung die gewünschte Bahnbewegung des Quadrocopters zur \DIFdelbegin \DIFdel{Ursache }\DIFdelend \DIFaddbegin \DIFadd{Folge }\DIFaddend hat. In einem realen System ist dies durch \DIFdelbegin \DIFdel{ein Flüsse }\DIFdelend \DIFaddbegin \DIFadd{Einflüsse aus }\DIFaddend der Umgebung, \DIFdelbegin \DIFdel{bsp}\DIFdelend \DIFaddbegin \DIFadd{bspw}\DIFaddend . Wind nicht \DIFdelbegin \DIFdel{gewährleiste}\DIFdelend \DIFaddbegin \DIFadd{gewährleistet}\DIFaddend . Deshalb ist zusätzlich der Folgeregler (Kapitel \ref{sec:folgeregeler}) implementiert, dessen Aufgabe \DIFdelbegin \DIFdel{besteht darin Abweichung }\DIFdelend \DIFaddbegin \DIFadd{darin besteht Abweichungen }\DIFaddend der realen Zustände des Quadrocopters von den Referenzwerten \DIFdelbegin \DIFdel{auszuregelen}\DIFdelend \DIFaddbegin \DIFadd{auszuregeln}\DIFaddend . Die dafür benötigten Zustandsgrößen des Flugsystems (Kapitel \ref{sec:Zustandsbestimmung}) werden durch die Fusion\DIFdelbegin \DIFdel{der in }\DIFdelend \DIFaddbegin \DIFadd{, der }\DIFaddend über \DIFdelbegin \DIFdel{den }\DIFdelend Laser bestimmten Position(Kapitel \ref{chap:2Dpositionsbestimmung}) \DIFdelbegin \DIFdel{mit den mit den }\DIFdelend \DIFaddbegin \DIFadd{sowie den }\DIFaddend Beschleunigungswerten der \gls{imu} \DIFdelbegin \DIFdel{ermittelt}\DIFdelend \DIFaddbegin \DIFadd{bestimmt}\DIFaddend .

Bevor jede einzelne Komponente in den \DIFdelbegin \DIFdel{Folgekapiteln }\DIFdelend \DIFaddbegin \DIFadd{folgenden Kapiteln }\DIFaddend hergeleitet wird, ist in Abbildung~\ref{fig:strucregelung} die Verknüpfung aller Komponenten noch einmal grafisch dargestellt.
\begin{figure}
	\centering
	\includegraphics[width = .85\textwidth]{images/Reglerstruktur}
	\caption[Gesamtstruktur Regelung]{Struktur der Regelung (AscTec\_Framework)} %
	\label{fig:strucregelung}
\end{figure}


Anzumerken ist, \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{dass }\DIFaddend die in Verbindung mit \gls{asctec} entworfene Positionsregelung \DIFdelbegin \DIFdel{, }\DIFdelend zur Ausrichtung des Quadrocopters in einem dreidimensionalen Raum \DIFdelbegin \DIFdel{entworfen }\DIFdelend \DIFaddbegin \DIFadd{entwickelt }\DIFaddend ist. Für die vertikale Positionierung ist \DIFdelbegin \DIFdel{jedoch in der vorrangegangen }\DIFdelend \DIFaddbegin \DIFadd{bereits in der vorausgegangenen }\DIFaddend Arbeit\cite{JanKal13} von Jan Kallwies \DIFdelbegin \DIFdel{bereits eine Regelung entworfen worden}\DIFdelend \DIFaddbegin \DIFadd{eine Regelung beschrieben}\DIFaddend . Da diese Regelung Effekte\DIFaddbegin \DIFadd{, }\DIFaddend wie den Groundeffekt \footnote{In Bodennähe verhindert der Untergrund das schnelle Abströmen des durch die Rotoren erzeugten Luftstroms. Die daraus resultierende Krafterhöhung bei gleichbleibender Drehzahl der Rotoren, wird als Groundeffekt bezeichnet. } berücksichtigt, ist es \DIFdelbegin \DIFdel{Aufgabe einer dieser Arbeit folgenden Studentischen Projekt diese }\DIFdelend \DIFaddbegin \DIFadd{die Aufgabe eines auf diese Arbeit folgenden studentischen Projektes, selbige }\DIFaddend in das System der ETH-Zürich einzupflegen. \DIFdelbegin \DIFdel{Somit }\DIFdelend \DIFaddbegin \DIFadd{Dadurch }\DIFaddend reduziert sich die Validierung der \DIFdelbegin \DIFdel{Reglerstrukutur auf den }\DIFdelend \DIFaddbegin \DIFadd{Reglerstruktur auf die }\DIFaddend horizontale Ebene. 

 

%*************************************************************************************************************************

\section{Modellbildung}
\label{sec:Modelbildung}
Die Modellbildung ist die Grundlage für den systematischen Entwurf einer Zustandsregelung. Dabei wird das Systemverhalten in Form von Differentialgleichungen abgebildet. Diese beschreiben die zeitliche Veränderung einer Ausgangsgröße in Abhängigkeit ihrer zeitlichen Ableitungen sowie \DIFdelbegin \DIFdel{veränderlicher }\DIFdelend \DIFaddbegin \DIFadd{veränderlichen }\DIFaddend Eingangsgrößen. So lassen sich unter Beachtung der physikalischen Gesetze Bewegungsgleichungen aufstellen, welche das räumliche und zeitliche Verhalten einen mechatronischen Systems abbilden. 

Bevor \DIFdelbegin \DIFdel{jedoch }\DIFdelend die Bewegungsgleichungen des Quadrocopter aufgestellt werden\DIFdelbegin \DIFdel{können}\DIFdelend , ist es notwendig\DIFaddbegin \DIFadd{, }\DIFaddend die Freiheitsgrade des dynamischen Systems gegenüber des Bezugssystem zu bestimmen. Da zwischen dem n-frame(Bezugssystem) und dem b-frame(Quadrocopter) keine mechanische Verbindung oder konstante Koordinatentransformation existiert\DIFaddbegin \DIFadd{, }\DIFaddend besitzt das Flugsystem sechs Freiheitsgrade\DIFdelbegin \DIFdel{. Bestehend }\DIFdelend \DIFaddbegin \DIFadd{, bestehend }\DIFaddend aus drei rotativen $\begin{bmatrix} \phi&\theta&\psi\end{bmatrix}^T$ und drei translatorischen $\begin{bmatrix} x&y&z\end{bmatrix}^T$. Sechs Freiheitsgrade sind gleichzusetzen mit sechs Differentialgleichungen zur Beschreibung der Bewegung im Raum. Damit \DIFdelbegin \DIFdel{ist jedoch }\DIFdelend \DIFaddbegin \DIFadd{sind }\DIFaddend nicht alle Dynamiken des Systems abgebildet. So sind zur \DIFdelbegin \DIFdel{Beschreiben }\DIFdelend \DIFaddbegin \DIFadd{Darstellung }\DIFaddend des Gesamtsystems weitere Differentialgleichungen aufzustellen. Zum einen ist hier die Dynamik der Elektromotoren \DIFdelbegin \DIFdel{zu einzukalkulieren}\DIFdelend \DIFaddbegin \DIFadd{einzukalkulieren, }\DIFaddend welche die Rotoren antreiben. \DIFdelbegin \DIFdel{Als }\DIFdelend \DIFaddbegin \DIFadd{Des Weiteren }\DIFaddend auch die durch die Rotation der Rotorblätter ausgelöste Schubentwicklung nach den Gesetzen der Strömungslehre. Unter Beachtung aller Aspekte entsteht so eine mathematisch meist nichtlineare sowie sehr aufwendige und komplexe Systembeschreibung. Da mit der \DIFdelbegin \DIFdel{steigender }\DIFdelend \DIFaddbegin \DIFadd{steigenden }\DIFaddend Größe auch die Fehleranfälligkeit steigt, wird in der Modellbildung folgender Leitsatz \DIFdelbegin \DIFdel{immer wieder }\DIFdelend \DIFaddbegin \DIFadd{wiederholt }\DIFaddend aufgeführt. \glqq Ein Modell sollte das zu regelende Verhalten so einfach wie möglich \DIFdelbegin \DIFdel{, aber }\DIFdelend \DIFaddbegin \DIFadd{und }\DIFaddend so detailliert wie nötig darstellen.\grqq \DIFdelbegin \DIFdel{Betrachtet nun die Struktur des }\DIFdelend \DIFaddbegin \DIFadd{Wird die Struktur der }\DIFaddend implementierten Flugregelung (Abbildung \ref{fig:strucregelung}) \DIFdelbegin \DIFdel{so lässt }\DIFdelend \DIFaddbegin \DIFadd{betrachtet, reduziert }\DIFaddend sich das Modell aus Sicht der Positionsregelung \DIFdelbegin \DIFdel{stark reduzieren}\DIFdelend \DIFaddbegin \DIFadd{erheblich}\DIFaddend .  

Grund hierfür ist die in Bild \ref{fig:kaskstruc} dargestellte Kaskadenstruktur der Regelung. In Verbindung mit Abbildung \ref{fig:strucregelung} ist zu erkennen, \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{dass }\DIFaddend der Lageregelung als Eingangsgrößen eine Soll-Orientierung $ O_{des} =\begin{bmatrix} \phi&\theta&\psi\end{bmatrix}^T $ und \DIFdelbegin \DIFdel{ein }\DIFdelend \DIFaddbegin \DIFadd{eine }\DIFaddend Schubvorgabe $T_{des}$ übergeben wird. Aus Sicht der Positionsregelung sind \DIFdelbegin \DIFdel{dies }\DIFdelend \DIFaddbegin \DIFadd{das }\DIFaddend auch die Eingänge des zu regelnden Modells. Fest steht\DIFdelbegin \DIFdel{somit, das }\DIFdelend \DIFaddbegin \DIFadd{, dass sowohl }\DIFaddend die rotative Dynamik als auch die Schubentwicklung über den auf dem \gls{llp} befindliche Regler eingestellt wird. Dieser ist ab Werk so gut parametriert, \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{dass }\DIFaddend die Zeitkonstante zwischen Vorgabe und Einstellen des Sollwerts sehr gering ist. Dies wurde \DIFdelbegin \DIFdel{auch }\DIFdelend durch einen Versuch bestätigt. Da der Aufbau der Lageregelung nicht bekannt ist\DIFdelbegin \DIFdel{wurde }\DIFdelend \DIFaddbegin \DIFadd{, wird }\DIFaddend dazu das experimentelle Systemidentifikationstool von Manfred Ottens herangezogen. Um die Zeitkonstante schätzen zu können\DIFdelbegin \DIFdel{wurde }\DIFdelend \DIFaddbegin \DIFadd{, wird }\DIFaddend das Übertagungsverhalten von Ist- zu Soll-Winkel als PT1-Glied abstrahiert. \DIFdelbegin \DIFdel{Aus }\DIFdelend \DIFaddbegin \DIFadd{Die Zeitkonstante T wird aus }\DIFaddend den Messdaten des \DIFdelbegin \DIFdel{Sollwert und Istwert wurde daraus die Zeitkonstante T }\DIFdelend \DIFaddbegin \DIFadd{Sollwertes und des Istwertes }\DIFaddend ermittelt. Dabei \DIFdelbegin \DIFdel{ergab das mittel }\DIFdelend \DIFaddbegin \DIFadd{ergibt das Mittel }\DIFaddend über mehrere Messungen \DIFdelbegin \DIFdel{einen }\DIFdelend \DIFaddbegin \DIFadd{eine }\DIFaddend Zeitkonstante von T$\approx0.1~s$. Mit der Gewissheit, \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{dass }\DIFaddend die Dynamik der Positionsregelung um ein vielfaches geringer ausfällt\DIFdelbegin \DIFdel{lässt }\DIFdelend \DIFaddbegin \DIFadd{, vernachlässigt }\DIFaddend sich beim Entwurf \DIFdelbegin \DIFdel{dieser }\DIFdelend die Zeitkonstante T \DIFdelbegin \DIFdel{vernachlässigen}\DIFdelend \DIFaddbegin \DIFadd{dieser Regelung}\DIFaddend . Es gilt somit Soll- entspricht Ist-Winkel.
 \begin{equation}
  O_{des} = O = \begin{bmatrix} \phi&\theta&\psi\end{bmatrix}^T
 \end{equation}

Somit reduziert sich die für Positionsregelung zu modellierende Dynamik auf die translatorische Differenzialgleichungen. Um zur Bestimmung dieser die Newtonsche Gesetze anwenden zu können, werden diese im n-frame definiert. Dabei kann der Quadrocopter als widerstandsfreie Kugel im dreidimensionalen Raum des Navigationskoordinatensystems abgebildet werden. Auf diese wirkt parallel zur z-Achse des n-frames die Gravitationskraft $ F^n_g $ und die in Richtung der $ z^b $-Achse angreifender Gesamtschub $ T $ (Gleichung \ref{eq:Schubvektor}) der Rotoren. \DIFdelbegin \DIFdel{Letzt genannte Kraft muss }\DIFdelend \DIFaddbegin \DIFadd{Letztgenannte Kraft wird }\DIFaddend zur Anwendung der Newtonischen Gesetze in Kraftkomponenten des n-frames zerlegt \DIFdelbegin \DIFdel{werden }\DIFdelend (Abbildung \ref{fig:F_nframe}).
\begin{figure}
	\centering
	\includegraphics[width = .85\textwidth]{images/Force_nframe}
	\caption[]{Auf den Quadrocopter wirkende Kraft. Definiert im n-frame} %
	\label{fig:F_nframe}
\end{figure}     
Da die Dynamik der Lageregelung vernachlässigt wird, ist dies über eine einfache Koordinatentransformation vom b-frame ins n-frame realisierbar. Die entsprechende Transformation \DIFdelbegin \DIFdel{wurde }\DIFdelend \DIFaddbegin \DIFadd{ist }\DIFaddend in Kapitel \ref{subsec:koordinatentransformation} in Formel \ref{eq:inverse_transM} eingeführt. Daraus ergibt sich\DIFdelbegin \DIFdel{,
}\DIFdelend \DIFaddbegin \DIFadd{:
}\DIFaddend 

\begin{equation}
 F^n =	\begin{bmatrix}
	F^n_x \\
	F^n_y \\
	F^n_z \\
	\end{bmatrix}
	=
	M_{nb} \cdot F^b - F_g 
	=
	M_{nb} \cdot 
	\begin{bmatrix}
	0 \\
	0 \\
	T \\
	\end{bmatrix}
	-
	\begin{bmatrix}
	0 \\
	0 \\
	F_g \\
	\end{bmatrix}.
	\label{eq:superposF}
\end{equation} 

Nach dem zweiten Newtonschen Gesetz lässt sich \DIFdelbegin \DIFdel{nun }\DIFdelend die Beschleunigung $ a $ des Körpers bestimmen. Dieses besagt, eine Änderung der Bewegung resultiert proportional und gradlinig in Richtung der wirkenden Kraft. Dabei gilt die Beziehung. 

\begin{equation}
F^n =	\begin{bmatrix}
F^n_x \\
F^n_y \\
F^n_z \\
\end{bmatrix}
= m \cdot a = m \cdot	
\begin{bmatrix}
a^n_x \\
a^n_y \\
a^n_z \\
\end{bmatrix}
\label{eq:fma}
\end{equation} 

Für die konstante Masse $ m (= 1.863~kg) $ des Quadrocoters, lassen sich die Beschleunigungen des Körpers im dreidimensionalen Raum durch \DIFdelbegin \DIFdel{einsetzen }\DIFdelend \DIFaddbegin \DIFadd{Einsetzen }\DIFaddend von (\ref{eq:superposF}) in (\ref{eq:fma}) berechnen.
\begin{equation}
\begin{bmatrix}
a^n_x \\
a^n_y \\
a^n_z \\
\end{bmatrix}
=
\frac{1}{m} \cdot (
M_{nb} \cdot 
\begin{bmatrix}
0 \\
0 \\
T \\
\end{bmatrix}
-
\begin{bmatrix}
0 \\
0 \\
F_g \\
\end{bmatrix}
)
\label{eq:beschl}
\end{equation}

Basierend auf dem Weg-Zeit-Gesetz \cite{physik} \DIFdelbegin \DIFdel{lässt }\DIFdelend \DIFaddbegin \DIFadd{bestimmt }\DIFaddend sich für eine Anfangsgeschwindigkeit $ v^n_0  $ und eine Startposition $ P^n_0 $ die Position des Quadrocopters über die doppelte Integration der Beschleunigung aus Gleichung (\ref{eq:beschl})\DIFdelbegin \DIFdel{bestimmen}\DIFdelend .
\begin{equation}
\begin{split}
a^n &= \dot{v}^n = \ddot{P}^n\\
v^n &= \dot{a}^n = \int a^n dt + v^n_0\\
P^n &= \int v^n dt + P^n_0
\end{split}
\label{eq:weg-zeit}
\end{equation}

Mit diesen \DIFdelbegin \DIFdel{Gleichung }\DIFdelend \DIFaddbegin \DIFadd{Gleichungen }\DIFaddend \ref{eq:weg-zeit} und \ref{eq:beschl} ist das translatorische Systemverhalten des Quadrocopters im n-frame mathematisch beschreibbar. Abhängig der Einganggrößen $ O_des $ und $ T_des $. Die resultierende Beschreibung der Zustände $ x =\begin{bmatrix}
v_x &
v_y &
v_z &
x &
y &
z 
\end{bmatrix}^T $ des Modells ergibt.
\begin{equation}
\begin{split}
\dot{x}_1 &= \frac{1}{m} \cdot ((\cos\phi\sin\theta\cos\psi+\sin\phi\sin\psi)\cdot T)\\
\dot{x}_2 &= \frac{1}{m} \cdot ((\cos\phi\sin\theta\sin\psi-\sin\phi\cos\psi)\cdot T)\\
\dot{x}_3 &= \frac{1}{m} \cdot ((\cos\phi\cos\theta)\cdot T)-g\\
\dot{x}_4 &= x_1\\
\dot{x}_5 &= x_2\\
\dot{x}_6 &= x_3\\
\end{split}
\label{eq:zstd}
\end{equation}
Zur Veranschaulichung ist das Modell zusätzlich in Abbildung \label{fig:modstrukquad} visualisiert. 
\begin{figure}
	\centering
	\includegraphics[width = \textwidth]{images/modell_lage_trans}
	\caption[]{Modellstruktur des Quadrocopters (FEHLER, GEWICHTSKRAFT FEHLT UND SUBTRANS ALS NICHTLINEAR MARKIEREN)} %
	\label{fig:modstrukquad}
\end{figure}

 
Durch die Koordinatentransformation bzw. die \DIFdelbegin \DIFdel{trigonometrichen }\DIFdelend \DIFaddbegin \DIFadd{trigonometrischen }\DIFaddend Funktionen ist die Systembeschreibung nichtlinear. Das bedeutet, \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{dass }\DIFaddend von der Änderung der Eingangsgrößen keine \DIFdelbegin \DIFdel{direkt porportionale }\DIFdelend \DIFaddbegin \DIFadd{direkte proportionale }\DIFaddend Änderung der Ausgangsgröße ableitbar ist. Somit ist eine direkte Ansteuerung der Lageregelung über einen linearen Positionsregler nicht möglich\DIFdelbegin \DIFdel{ist}\DIFdelend . Da allerdings \DIFdelbegin \DIFdel{einen ein solche }\DIFdelend \DIFaddbegin \DIFadd{ein solcher }\DIFaddend linearer Regler vorgesehen ist, \DIFaddbegin \DIFadd{wird ein Baustein }\DIFaddend benötigt\DIFdelbegin \DIFdel{man einen Baustein . Der }\DIFdelend \DIFaddbegin \DIFadd{, der }\DIFaddend für fiktive Eingänge das Systemverhalten linearisiert.    

%%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\section{Exakte Zustandslinearisierung}
\label{sec:exkt.zstdlin}
Zur Linearisierung eines nichtlinearen Modells wird in den Grundlagen der Regelungstechnik \cite{lunze08} die Arbeitspunktlinearisierung gelehrt. Nachteil \DIFdelbegin \DIFdel{eine solche Linearisierung besitzt oft nur }\DIFdelend \DIFaddbegin \DIFadd{einer solchen Linearisierung ist, dass sie oft nur Gültigkeit }\DIFaddend für eine \DIFdelbegin \DIFdel{kleinen }\DIFdelend \DIFaddbegin \DIFadd{kleine }\DIFaddend Umgebung um den Arbeitspunkt \DIFdelbegin \DIFdel{Gültigkeit}\DIFdelend \DIFaddbegin \DIFadd{besitzt}\DIFaddend . Um mit dem Quadrocopter schnelle Positionswechsel vollziehen zu können, werden jedoch hohe Stellwinkel benötigt. Somit ist eine annähernde Linearisierung für einen Arbeitspunkt nicht ausreichend. Es wird daher eine Methode benötigt, die das Modell über den gesamten Arbeitsbereich linearisiert. 
\begin{figure}
	\centering
	\includegraphics[width = \textwidth]{images/inversion}
	\caption[]{Gesamtinversion} %
	\label{fig:Gesamtinversion}
\end{figure} 

In \cite{deutNL} wird dafür die exakte Zustandslinearisierung eingeführt. Dabei wird dem nichtlinearen System eine Inversion vorgeschaltet. Diese beinhaltet eine linearisierendes Stellgesetz\DIFdelbegin \DIFdel{so, dass }\DIFdelend \DIFaddbegin \DIFadd{, sodass }\DIFaddend sich das zu regelnde System für jeden Ausgang als entkoppelt und lineare Integrierekette darstellt. 

%Betrachtet man die Modellstruktur für die translatorische Bewegung (Abbildung \ref{fig:modstrukquad}) so kann man erkennen, das für fiktive Eingänge $ u_f = \begin{bmatrix}
%a^n_x &
%a^n_y &
%y^n_z 
%\end{bmatrix}^T$ das Modell aus drei unabhängigen entkoppelten Integriererketten 2.Ordnung bestehen würde. Die per Definition der Linearität \cite{lunze08} ein lineares Zustandsverhalten aufweisen. Gesucht ist also ein Stellgesetz, das für die fiktiven Eingängen $ u_f $ die Stellgrößen der realen Eingänge $ u = \begin{bmatrix} 
%T  &
%\phi &
%\theta &
%\psi 
%
%\end{bmatrix} $ generiert. Eine sogenannte Inversion. \\

Das bedeutet für das Quadrocoptermodell (Kapitel \ref{sec:Modelbildung}). Es ist ein Stellgesetz für $ u = \begin{bmatrix} T  &\phi &\theta &\psi \end{bmatrix} $ gesucht, welches das System für die Ausgänge $ y =  \begin{bmatrix} 
x & y & z \end{bmatrix} $ entkoppelt. Für die Positionsregelung \DIFdelbegin \DIFdel{steht so }\DIFdelend \DIFaddbegin \DIFadd{stehen }\DIFaddend die fiktiven Eingänge $u_f = \begin{bmatrix} a^n_x &	a^n_y & y^n_z \end{bmatrix}^T$ zur Verfügung. Das bedeutet\DIFaddbegin \DIFadd{, }\DIFaddend es können ohne Berücksichtigung der Orientierung des Quadrocopters Beschleunigungswerte im n-frame vorgegeben werden.

Damit eine solche Inversion für die Position als Ausgang $ y =  \begin{bmatrix}x & y & z & \end{bmatrix} $ möglich ist, muss es sich bei diesem Ausgang um einen so genannten flachen Ausgang $ y_f = \begin{bmatrix} y_{f1} & y_{f2} & y_{f3} \end{bmatrix}$ handeln. 

%Vollständige Definition siehe Anhang \ref{anh:def_fl}.  
%Damit aus dem nichtlinearen Modell Kapitel \ref{sec:Modelbildung} ein Exakt zustandslinearisierendes Stellgesetz (Inversion) generiert werden kann, muss es sich bei dem Ausgang $ y =  \begin{bmatrix} 
%x &
%y &
%z &  
%\end{bmatrix} $  um einen sogenannten flachen Ausgang $ y_f = \begin{bmatrix} 
%y_{f1} &
%y_{f2} &
%y_{f3} 
%\end{bmatrix}$ handeln. 

Per Definition (Anhang \ref{anh:def_fl}) muss dafür das Kriterium, Anzahl der flachen Ausgänge $ p_y $ \DIFdelbegin \DIFdel{entspricht }\DIFdelend \DIFaddbegin \DIFadd{entsprechend }\DIFaddend der Anzahl der Eingänge $ p_u $des nichtlinearen Systems, \DIFdelbegin \DIFdel{erfühlt }\DIFdelend \DIFaddbegin \DIFadd{erfüllt }\DIFaddend sein. Dieses \DIFaddbegin \DIFadd{Kriterium }\DIFaddend ist für $ y_f = \begin{bmatrix} x & y & z \end{bmatrix}$ und die Eingangsgrößen $ u = \begin{bmatrix} T  & \phi & \theta & \psi \end{bmatrix} $ verletzt.
%kann es sich bei dem gewünschten flachen Ausgang $ y_f = \begin{bmatrix} 
%x &
%y &
%z 
%\end{bmatrix}$ nur um einen solchen Handeln wenn die Anzahl der flachen Ausgänge $ p $ derer der realen Eingänge $ u $ entspricht. Dies ist nicht der Fall.
Nach \cite{deutNL} heißt das, es muss ein neuer fiktiver Ausgang gesucht werden, sodass  $ p_y  = p_u$ gilt. Dieser neue Ausgang \DIFdelbegin \DIFdel{würde }\DIFdelend \DIFaddbegin \DIFadd{entspricht }\DIFaddend nicht mehr der Position\DIFdelbegin \DIFdel{entsprechen}\DIFdelend . Das bedeutet\DIFdelbegin \DIFdel{Positionsvorgaben müssten }\DIFdelend \DIFaddbegin \DIFadd{, Positionsvorgaben müssen }\DIFaddend erst in die neuen Ausgänge transformierten werden. Auch der gewünschte fiktive Eingang der $u_f = \begin{bmatrix} a^n_x &	a^n_y & y^n_z \end{bmatrix}^T$ \DIFdelbegin \DIFdel{wäre }\DIFdelend \DIFaddbegin \DIFadd{ist }\DIFaddend nicht mehr gegeben.

\DIFdelbegin \DIFdel{Deshalb }\DIFdelend \DIFaddbegin \DIFadd{Aus diesem Grund }\DIFaddend bedient sich die in Kooperation mit AscTec entwickelte Inversion \cite{Achtelik11} einem Trick. 

% Damit dennoch eine Inversion durchgeführt werden kann, ist es möglich ein flacher Ausgang mit der selben Anzahl an Ausgängen wie Eingängen zu suchen. Dieser würde nicht mehr mit der Position $ P^n $ übereinstimmen. Deshalb wurde in Paper \cite{Achtelik11} ein anderer Weg eingeschlagen.  

Um die Position als flachen Ausgang zu erhalten, bedient man sich der Tatsache, \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{dass }\DIFaddend eine Veränderung des $ \psi $-Winkels zu keiner Auslenkung des Schubvektors $ T $ führt. So können die Beschleunigungsvorgaben $ u_f $ über eine einfache Transformation (Gleichung \ref{eq:Mz}) um den Winkel $ \psi $ ins o-frame übertragen werden $\tilde{u}_f = \begin{bmatrix} a^o_x &	a^o_y & y^o_z \end{bmatrix}^T$. Gleiches gilt auch für den zugehörigen Ausgang $ y_f $. \DIFdelbegin \DIFdel{Somit }\DIFdelend \DIFaddbegin \DIFadd{Demzufolge }\DIFaddend ergibt sich für diesen $\tilde{y}_f = \begin{bmatrix} y^o_{f1} &	y^o_{f2} & y^o_{f2} \end{bmatrix}$.Durch \DIFdelbegin \DIFdel{diesen }\DIFdelend \DIFaddbegin \DIFadd{den }\DIFaddend Trick reduziert sich \DIFdelbegin \DIFdel{die }\DIFdelend \DIFaddbegin \DIFadd{für die Inversion die }\DIFaddend Anzahl der Eingänge \DIFdelbegin \DIFdel{der für Inversion }\DIFdelend um einen. So entspricht die Anzahl der verbliebenen Eingängen $ \tilde{u} = \begin{bmatrix} \phi & \theta & T \end{bmatrix} $ denen des gewünschten flachen Ausgangs. Damit ist die Flachheit des Ausgangs $ \tilde{y}_f $ nicht erwiesen. Es fehlt per Definition (vgl. Anhang \ref{anh:def_fl}) noch der Beweis, \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{dass }\DIFaddend sich alle Zustände $ \tilde{x} $ (vgl. Abbildung \ref{fig:modstrukquad}) und die reduzierten Eingänge $ \tilde{u} $ durch die flachen Ausgänge $ \tilde{y}_f $ und dessen Ableitungen darstellen lassen. Für die Zustände ist dieser Beweis, ohne großen Rechenaufwand möglich.

\begin{equation}
\begin{split}
\tilde{y}^o_{f1} &= x^o = x_4 \\
\tilde{y}^o_{f2} &= y^o = x_5 \\
\tilde{y}^o_{f3} &= z^o = x_6 \\
\\\dot{\tilde{y}}^o_{f1} &= \dot{x}^o = x_1 \\
\dot{\tilde{y}}^o_{f2} &= \dot{x}^o = x_2 \\
\dot{\tilde{y}}^o_{f3} &= \dot{z}^o = x_3 
\end{split}
\end{equation}

Für die Eingangsgrößen $ \tilde{u} $ \DIFdelbegin \DIFdel{müssen }\DIFdelend \DIFaddbegin \DIFadd{werden }\DIFaddend die Zustandsgleichungen für $ \dot{\tilde{x}}_1$, $ \dot{\tilde{x}}_2 $ und $ \dot{\tilde{x}}_3 $ (vgl. Gleichung \ref{eq:zstd}) nach $ \phi $, $ \theta $ und $ T $ aufgelöst\DIFdelbegin \DIFdel{werden}\DIFdelend . Dabei entspricht $ \dot{\tilde{x}}_1 = a^o_x = \ddot{\tilde{y}}_{f1} = \tilde{u}_{f1}$, $ \dot{\tilde{x}}_2 = a^o_y = \ddot{\tilde{y}}_{f2} = \tilde{u}_{f2}$ sowie $ \dot{\tilde{x}}_3 = a^o_z = \ddot{\tilde{y}}_{f3} = \tilde{u}_{f3}$. Damit \DIFdelbegin \DIFdel{kann }\DIFdelend \DIFaddbegin \DIFadd{wird }\DIFaddend der Schub $ T $ als Betrag der im o-frame wirkenden Kräfte, bzw. geforderten Beschleunigungen multipliziert mit der Masse dargestellt\DIFdelbegin \DIFdel{werden}\DIFdelend .

\begin{equation}
\begin{split}
T &= m \cdot \sqrt{\ddot{\tilde{y}}_{f1}^2 +\ddot{\tilde{y}}_{f}^2+(\ddot{\tilde{y}}_{f3}+g )^2 }\\
&= m \cdot \sqrt{{a^o_x}^2 +{a^o_y}^2+(a^o_z+g)^2}
\end{split}
\label{eq:invT}
\end{equation}    

\DIFdelbegin \DIFdel{Nun da }\DIFdelend \DIFaddbegin \DIFadd{Da }\DIFaddend $ T $ bestimmt \DIFaddbegin \DIFadd{ist}\DIFaddend , ist unter Beachtung das $ \psi = 0 $, durch die vorgelagerte Transformation, $ \dot{\tilde{x}}_2 $ aus  Gleichung \ref{eq:zstd} nach  $ \phi $ aufzulösen. Damit ergibt sich\DIFdelbegin \DIFdel{,
}\DIFdelend \DIFaddbegin \DIFadd{:
}\DIFaddend 

\begin{equation}
\begin{split}
\phi &= -\arcsin(\frac{\ddot{\tilde{y}}_{f2}\cdot m}{T})\\
& = -\arcsin(\frac{a^o_y\cdot m}{T}).
\end{split}
\label{eq:invphi}
\end{equation}

$ \theta $ lässt sich aufgrund der trigonometrischen Beziehung $ tan\alpha = \frac{\sin\alpha}{\cos\alpha} $ aus den Zustandsgleichungen für $ \dot{\tilde{x}}_1 $ und $ \dot{\tilde{x}}_3 $ berechnen.
\begin{equation}
\begin{split}
\theta &= \arctan(\frac{\ddot{\tilde{y}}_{f1}}{\ddot{\tilde{y}}_{f3}+g})\\
&=\arctan(\frac{a^o_x}{a^o_z+g})
\end{split}
\label{eq:invtheta}
\end{equation}

\begin{figure}
	\centering
	\includegraphics[width = .85\textwidth]{images/3intket}
	\caption[]{Modell aus Sicht der Positionsregelung dank Inversion} %
	\label{fig:drIntket}
\end{figure}

Die Stellgesetze der exakten Zustandslinearisierung sind damit über Gleichung (\ref{eq:invT}), (\ref{eq:invphi}) und (\ref{eq:invtheta}) mathematisch beschrieben. In Verbindung mit der Koordinatentransformation von $ \psi $ ergibt sich die in Abbildung \ref{fig:Gesamtinversion} dargestellte Inversion.

Die Richtigkeit \DIFdelbegin \DIFdel{dieser }\DIFdelend lässt sich über eine Simulation beweisen. Das Modell besteht dabei aus Inversion (Abbildung \ref{fig:Gesamtinversion}) und Translationsmodell (Abbildung \ref{fig:modstrukquad}). Über den neuen Eingang $ u_f $ werden dabei Beschleunigungswerte im n-frame vorgegeben (Abbildung \ref{fig:inv_uf}). Unter Einfluss ständig \DIFdelbegin \DIFdel{wechselnden  
}\DIFdelend \DIFaddbegin \DIFadd{wechselnder  
}\DIFaddend Orientierung um die Hochachse (Abbildung), ergeben sich die in \DIFaddbegin \DIFadd{der }\DIFaddend Abbildung dargestellten Vorgaben für das \DIFdelbegin \DIFdel{Exaktzustandslineariesierden }\DIFdelend \DIFaddbegin \DIFadd{Exaktzustandslinearisierende }\DIFaddend Stellgesetz. Die daraus resultierende Schubvorgabe und Winkel werden dem Bewegungsmodell übergeben. Mit dem \DIFdelbegin \DIFdel{Ergenis, das die resultierendne }\DIFdelend \DIFaddbegin \DIFadd{Ergebnis, dass die resultierenden }\DIFaddend Beschleunigungen des Modells \DIFdelbegin \DIFdel{denn Beschleunigunsvorgaben entspricht}\DIFdelend \DIFaddbegin \DIFadd{den Beschleunigunsvorgaben entsprechen}\DIFaddend .

Dadurch \DIFdelbegin \DIFdel{kann nun }\DIFdelend \DIFaddbegin \DIFadd{wird }\DIFaddend das zu regelnde System als lineares Modell\DIFaddbegin \DIFadd{, }\DIFaddend bestehend aus drei entkoppelten Integrierketten (Abbildung \ref{fig:drIntket})\DIFdelbegin \DIFdel{gesehen werden}\DIFdelend \DIFaddbegin \DIFadd{, gesehen}\DIFaddend . Dieses System ist jedoch instabil. Das bedeutet \DIFdelbegin \DIFdel{, }\DIFdelend für \DIFaddbegin \DIFadd{die }\DIFaddend Vorgabe einer konstanten Beschleunigung \DIFdelbegin \DIFdel{, }\DIFdelend schwingt der Quadrocopter auf keiner konstanten Position ein, sondern Integriert seine Position immer weiter auf. Begründet ist \DIFdelbegin \DIFdel{diese }\DIFdelend \DIFaddbegin \DIFadd{dieses }\DIFaddend Verhalten auch durch das Weg-Zeit-Gesetz (Gleichung \ref{eq:weg-zeit}). \DIFdelbegin \DIFdel{Möglich ist es jedoch }\DIFdelend \DIFaddbegin \DIFadd{Es besteht die Möglichkeit }\DIFaddend einen Beschleunigungsverlauf vorzugeben, für den der Quadrocopter in eine neue Position überführt wird. Dafür \DIFdelbegin \DIFdel{benötigt }\DIFdelend wird eine Vorsteuerung \DIFaddbegin \DIFadd{benötigt}\DIFaddend .


 \begin{figure}

 	\centering{
 		\subfloat[Neue fiktive Eingänge]{
 			\includegraphics[width=0.5\textwidth]{images/inv_uf}
 			\label{fig:inv_uf}
 		}
 		\subfloat[Orientierung um z-Achse]{
 			\includegraphics[width=0.5\textwidth]{images/inv_psi}
 			\label{fig:inv_psi}
 		}\\
 		\subfloat[Ins o-frame transformierte Beschleunigungsvorgaben]{
 			\includegraphics[width=0.5\textwidth]{images/inv_aso}
 			\label{fig:inv_aso}
 		}
 		\subfloat[Schubvorgabe der Inversion]{
 			\includegraphics[width=0.5\textwidth]{images/inv_T}
 			\label{fig:inv_T}
 		}\\
 		\subfloat[Sollwinkel für die Lageregelung]{
 			\includegraphics[width=0.5\textwidth]{images/inv_phitheta}
 			\label{fig:inv_phitheta}
 		}
 			\subfloat[Beschleunigungswerte im Translationsmodell]{
 				\includegraphics[width=0.5\textwidth]{images/inv_amdl}
 				\label{fig:inv_amdl}
 			}
 	}	
 	\caption[Simulation Inversion]{Simulation der Inversion}
 	\label{fig:sim_inversion}
 \end{figure}



\section{Vorsteuerung/Referenzmodell}
\label{sec:referenzmodell}
Eine Vorsteuerung erzeugt anhand einer Sollwertvorgabe einen Stellgrößenverlauf, der \DIFdelbegin \DIFdel{benötigt wird um }\DIFdelend \DIFaddbegin \DIFadd{erforderlich ist, um das }\DIFaddend System im störungsfreien Fall in diesen Zustand zu überführen. In \cite{Achtelik11} wird deshalb auch von Referenzmodell gesprochen. 

Im Sachen Positionsregelung bedeutet \DIFdelbegin \DIFdel{dies, es wird eine }\DIFdelend \DIFaddbegin \DIFadd{das die Übergabe einer }\DIFaddend anzufliegende Position $ P^n_{cmd} $\DIFdelbegin \DIFdel{übergeben}\DIFdelend . Daraus generiert die Vorsteuerung eine Trajektorie. Der Pfad $ P^n_{ref} $ mit dem der Quadrocopter in den Zustand überführt \DIFdelbegin \DIFdel{werden soll }\DIFdelend \DIFaddbegin \DIFadd{wird, }\DIFaddend muss dabei einmal stetig differenzierbar sein. Der Grund, die Stellgröße der Inversion sind Beschleunigungsvorgaben. Demzufolge muss die zweite Ableitung der Position mindestens stückweise \DIFdelbegin \DIFdel{existiert}\DIFdelend \DIFaddbegin \DIFadd{existieren}\DIFaddend . Damit dies gewährleistet ist, ist nach \cite{deutNL} folgende Differenzialgleichung für das Referenzmodell aufzustellen. 

%Zur Vorgabe des gewünschte benötigt man als Vorsteuerung ein Referenzmodell. Diesem werden die anzufliegenden Positionen $ P^n_{cmd} $ übergeben. Aufgabe der Vorsteuerung ist es daraus eine Trajektorie zu generieren. Diese beschreibt den Pfad über den der Quadrocopter in diese Koordinate überführt wird. Da die neuen Eingangsgrößen $ u_f $ des zustandslinearisierten Modells Beschleunigungsvorgaben sind, muss der Verlauf der Positionsvorgabe der Vorsteuerung $ P^n_{ref} $ einmal stetig differenzierbar sein, sodass die zweite Ableitung existiert. Damit dies gewährleistet kann nach \cite{deutNL} die E/A Dynamik für dieses System über folgende Formel vorgegeben werden.

\begin{equation}
	\ddot{P}^n_{ref} + c_1 \cdot \dot{P}^n_{ref}+c_0\cdot P^n_{ref}=c_0 \cdot P^n_{cmd}
	\label{eq:dynref}
\end{equation}
Hierbei kann die Dynamik mit der das Fluggerät überführt \DIFdelbegin \DIFdel{werden soll}\DIFdelend \DIFaddbegin \DIFadd{wird}\DIFaddend , über die Koeffizienten eingestellt werden. Stellt man für (\ref{eq:dynref}) die Übertragungsfunktion $ G(s) $ auf.
\begin{equation}
\begin{split}
G(s)=\frac{P^n_{cmd}}{P^n_{ref}} &=\frac{c_0}{s^2+c_1\cdot s+c_0}\\
&= \frac{1}{\frac{1}{c_o}s^2+\frac{c_1}{c_0}\cdot s+1}
\end{split}	
\label{eq:gsref}
\end{equation}
\DIFdelbegin \DIFdel{Kann man erkennen das }\DIFdelend \DIFaddbegin \DIFadd{Erkennbar ist, dass }\DIFaddend diese in ihrer Form einem PT2-Glied entspricht.
\begin{equation}
	G_{PT2}(s)=\frac{1}{(\frac{1}{\omega_o})^2s^2+\frac{2D}{\omega_0}\cdot s+1}
	\label{eq:gspt2}
\end{equation}

Setzt man (\ref{eq:gspt2}) mit (\ref{eq:gsref}) gleich\DIFaddbegin \DIFadd{, }\DIFaddend kann man die Koeffizienten $ c_0 $ und $ c_1 $ abhängig der gewünschten Eigenfrequenz $ \omega_0 $ und Dämpfung $ D $ wählen.
\begin{equation}
c_0= \omega_0^2
\label{eq:ref_c0}
\end{equation}
\begin{equation}
c_1= 2 D\omega_0
\label{eq:ref_c1}
\end{equation}
Der Vorteil, die Dynamik der Vorsteuerung ist über die in den Grundlagen der Regelungstechnik vermittelten Entwurfskriterien für PT2-Glieder einstellbar.
So lässt sich über $ \omega $ einstellen\DIFdelbegin \DIFdel{wir }\DIFdelend \DIFaddbegin \DIFadd{, wie }\DIFaddend schnell die Zielkoordinate erreicht werden soll. Das wie, lässt sich über die Dämpfung $ D $ bestimmen. So wird für alle $ D \le 1 $ eine Pfad ohne Überschwinger generiert. 
Die Dynamikvorgabe ist \DIFdelbegin \DIFdel{jedoch }\DIFdelend durch die maximal zulässige Stellgröße beschränkt. So kann zumindest $ \omega $ nicht beliebig \DIFdelbegin \DIFdel{Groß }\DIFdelend \DIFaddbegin \DIFadd{groß }\DIFaddend gewählt werden. 

Der Stellgrößenverlauf $ u_{f_{ref}} = \ddot{P}^n_{ref}  $ ist \DIFdelbegin \DIFdel{somit }\DIFdelend \DIFaddbegin \DIFadd{damit }\DIFaddend über (\ref{eq:dynref}) mit (\ref{eq:ref_c0}) und (\ref{eq:ref_c1}) folgendermaßen festgelegt.
\begin{equation}
u_{f_{ref}} = \omega_0^2 \cdot(P^n_{cmd}-P^n_{ref})-2D\omega_0\cdot \dot{P}^n_{ref}
\label{eq:ref_mdl}
\end{equation}
%Vorteil dieser Darstellung ist, das die Dynamik der Vorsteuerung über die in den Grundlagen der Regelungstechnik \cite{lunze08} vermittelten Entwurfskriterien für PT2-Glieder bestimmen lässt. So ist die Schwingungsfähigkeit über die Dämpfung $ D $ beeinflussbar ($ D \le 1 $, keine Schwingung). Mit $ \omega_0 $ kann schließlich eingestellt werden wie schnell die Zielkoordinaten erreicht werden sollen. $ \omega $ ist da bei durch die maximal zulässige Stellgröße beschränkt.
\begin{figure}
	\centering
	\includegraphics[width = \textwidth]{images/refmdl}
	\caption[]{Strukturbild Vorsteuerung} %
	\label{fig:strucref}
\end{figure}
Das resultierende Strukturbild der Vorsteuerung ist in Abbildung \ref{fig:strucref} visualisiert. Für \DIFdelbegin \DIFdel{ein }\DIFdelend \DIFaddbegin \DIFadd{eine }\DIFaddend Positionsverschiebung von $ 1~m $ erzeugt das Referenzmodell die in Abbildung \ref{fig:tragen} Trajektorie bzw. den in Grafik \ref{fig:tragen_aref} dargestellten Stellwertverlauf. Hier ist anzumerken, \DIFdelbegin \DIFdel{das  }\DIFdelend \DIFaddbegin \DIFadd{dass }\DIFaddend aufgrund der entkoppelten Integriererketten (Kapitel \ref{sec:exkt.zstdlin}) eine separate Dynamikvorgabe für jeden Zweig des zustandslinearisierten Modells möglich ist. 
 \begin{figure}
 	\centering{
 		\subfloat[Positionsvorgabe über $ p_{cmd} $ und generierte Positionsvorgabe $ p_{ref} $]{
 			\includegraphics[width=0.5\textwidth]{images/p_cmdref}
 			\label{fig:tragen_pcmdref}
 		}\\
 		\subfloat[Geschwindigkeitsvorgabe $ v_{ref} = \dot{p}_{ref} $ der Trajektorie]{
 			\includegraphics[width=0.5\textwidth]{images/v_ref}
 			\label{fig:tragen_vref}
 		}
 		\subfloat[Beschleunigungsvorgabe $ u_{f_{ref}} = a_{ref} = \ddot{p}_{ref}$]{
 			\includegraphics[width=0.5\textwidth]{images/a_ref}
 			\label{fig:tragen_aref}
 		}
 	}	
 	\caption[Simulationsergebnisse Referenzmodell]{Simulationsergebnis des Referenzmodells für eine Achse mit $ \omega_0 = 1.5~Hz$ $ D = 1 $}
\label{fig:tragen}
 \end{figure}
Weiterhin besteht die Möglichkeit die Vorsteuerung auszubauen, \DIFdelbegin \DIFdel{so dass  }\DIFdelend \DIFaddbegin \DIFadd{sodass  }\DIFaddend Geschwindigkeitsvorgaben gemacht werden können. Dies erleichtert unter anderem das manuelle Navigieren mittels einer Fernsteuerung. Dabei erfolgt die Vorgabe der Soll-Geschwindigkeiten $ v^o_{cmd} $ im o-frame. Diese Vorgabe wird ins n-frame transformiert und dort über die Zeit integriert. Somit ergibt sich eine \DIFdelbegin \DIFdel{stetig }\DIFdelend \DIFaddbegin \DIFadd{stetige }\DIFaddend Positionsvorgabe für $ P^n_{cmd} $. 

\begin{equation}
P^n_{cmd} = \int (M_z^T\cdot v^o_{cmd}) dt + P^n_{cmd_0}
\label{eq:v_Pcmd}
\end{equation}

Mit dieser wird das Referenzmodell (\ref{eq:ref_mdl}) \DIFdelbegin \DIFdel{gespießt}\DIFdelend \DIFaddbegin \DIFadd{gespeist}\DIFaddend . Es wird ein Stellgröße erzeugt\DIFaddbegin \DIFadd{, }\DIFaddend für das die Position des Quadrocopter der stetigen Positionsvorgabe (\ref{eq:v_Pcmd}) folgt. Die maximale Geschwindigkeit ist deshalb durch die Grenzfrequenz $ \omega_0 $ des Referenzmodells begrenzt. Je größer $ \omega_0 $ \DIFdelbegin \DIFdel{die }\DIFdelend \DIFaddbegin \DIFadd{ist, }\DIFaddend desto höher die mögliche Geschwindigkeit.

Die Vorsteuerung ist \DIFdelbegin \DIFdel{somit }\DIFdelend \DIFaddbegin \DIFadd{hiermit }\DIFaddend für alle Anwendungszwecke entworfen. Speist man das exakt \DIFdelbegin \DIFdel{Zustandslinearisierte }\DIFdelend \DIFaddbegin \DIFadd{zustandslinearisierte }\DIFaddend mit dem in Abbildung \ref{fig:tragen} generierten Sollwertverlauf\DIFaddbegin \DIFadd{, }\DIFaddend so folgt der Quadrocopter der Trajektorie. Dies gilt allerdings nur für den Fall konsistenter Anfangszustände (Abbildung \ref{fig:vor_ohnestr}). Ist dies nicht gegeben, ist wie in Abbildung zu erkennen\DIFdelbegin \DIFdel{das Positionsverlauf des Translationsmodell }\DIFdelend \DIFaddbegin \DIFadd{, dass der Positionsverlauf des Translationsmodells }\DIFaddend für den gleichen Stellgrößenverlauf nicht der Referenz entspricht. Das gleiche gilt für Unsicherheiten der Modellparameter (Abbildung \ref{fig:vor_unsichmdlpara}). Hierbei berechnet die Inversion einen unzureichenden oder überdimensionierten Schubvektor. 

%Simuliert man das Modell (Abbildung \ref{fig:Gesamtinversion}) inklusive des Stellgesetzes der Vorsteuerung Gleichung (\ref{eq:ref_mdl}) für konsistente Anfangsbedingungen $ P_{ref0}^n = P_0^n $ so ergibt sich die gewünschte Flugkurve. In der Realität ist die Konsistens der Angfangsbedingungen jedoch nicht immer gegeben. 

\DIFdelbegin \DIFdel{Außerdem }\DIFdelend \DIFaddbegin \DIFadd{Unter anderem }\DIFaddend können äußere Krafteinwirkungen\DIFaddbegin \DIFadd{, }\DIFaddend wie zum Bespiel Winde wirken, die den Quadrocopter von der Trajektorie auslenken. Um all diesen Effekten entgegenzuwirken benötigt man einen Folgeregler. Dessen Aufgabe besteht darin\DIFaddbegin \DIFadd{, }\DIFaddend diese Einflüsse zu eliminieren, sodass \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{der }\DIFaddend Modellverlauf auch im gestörten Fall der Trajektorie entspricht.
 \begin{figure}
 	\centering{
 		\subfloat[Konsistente Anfangszustände $ p_{ref_0}~=~p_{mdl_0}~=~0 $ und $ v_{ref_0}~=v_{mdl_0}~=~0 $, ideales Modell]{
 			\includegraphics[width=0.5\textwidth]{images/vstr_ohnest}
 			\label{fig:vor_ohnestr}
 		}\\
 		\subfloat[Inkonsistene Anfangszustände $ p_{ref_0}~=~0~\ne~p_{mdl_0}~=~0.3 $ und $ v_{ref_0}~=~0~\ne~v_{mdl_0}~=~0.2 $, ideales Modell]{
 			\includegraphics[width=0.5\textwidth]{images/p_p0_03_v0_02}
 			\label{fig:vor_inkonAzust}
 		}
 		\subfloat[Unsicherheit der Modellparamter $ m_{inv}~\ne~m_{mdl} $]{
 			\includegraphics[width=0.5\textwidth]{images/p_m_mdl_2_5}
 			\label{fig:vor_unsichmdlpara}
 		}
 	}	
 	\caption[Referenzmodell als Vorsteuerung]{Steuerung der Regelstrecke über das Referenzmodell}
 	\label{fig:RefaliasVor}
\end{figure}
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Folgeregler}
\label{sec:folgeregeler}
Inkonsistente Anfangsbedingungen, externe Störungen sowie Modellunsicherheiten bewirken einen Ausgangsfolgefehler $e = P^n_{ref} - P^n $. Dieser \DIFdelbegin \DIFdel{Pflanzt }\DIFdelend \DIFaddbegin \DIFadd{pflanzt }\DIFaddend sich weiter fort, da es sich bei dem Stellsignal $  u_{f_{ref}} $ (\ref{eq:ref_mdl}) nicht um das Stellsignal $ u_f $ handelt\DIFaddbegin \DIFadd{, }\DIFaddend welches den Quadrocopter zurück auf die Trajektorie führt. \DIFdelbegin \DIFdel{Dies }\DIFdelend \DIFaddbegin \DIFadd{Das }\DIFaddend gilt auch im Falle eines unzureichenden Stellsignalverlaufs in Folge von Modellunsicherheiten. Modellieren lässt sich die Fortpflanzung des Folgefehlers aufgrund des linearisierten Modells in Form einer doppelten Integriererkette. 
%Dieser ergibt sich durch die Fortpflanzung des für das reale System nicht ausreichenden Stellsignals $\ddot{e} = u_{f_{ref}} - u_f$. Das bedeutet, die Fehlerdynamik kann ebenfalls über eine zweifache Integriererkette modelliert werden. 
Zweifache Integriererkette ergo instabiles System. Damit später die Flugbahn des Quadrocopter mit der Solltrajektorie konvergiert, muss die Fehlerdynamik stabilisiert werden. 
%Dafür ist es von nöten, die Dynamik der Folgefehler vorgeben zu können. 
Zu diesem Zwecke werden die Zustandsgrößen des Ausgangsfolgefehlermodells zurückgeführt (Abbildung \ref{fig:rückfolgefeh}). Daraus ergibt sich für die Vorgabe, dass der Folgefehler $ e $ in einer endlichen Zeit gegen $ 0 $ strebt, folgende Differentialgleichung.
\begin{figure}
	\centering
	\includegraphics[width = \textwidth]{images/fehlermdl}
	\caption[]{\DIFdelbeginFL \DIFdelFL{Ausgabgsfolgefehlermodell }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{Ausgangsfolgefehlermodell }\DIFaddendFL mit Zustandsrückführung} %
	\label{fig:rückfolgefeh}
\end{figure}
\begin{equation}
\ddot{e} + \tilde{c}_1 \cdot \dot{e}+ \tilde{c}_0\cdot e = 0
\label{eq:fehlerdyn}
\end{equation}
 \DIFdelbegin \DIFdel{mit 
}\DIFdelend \DIFaddbegin \DIFadd{Mit 
}\DIFaddend \begin{equation}
\begin{split}
e &= P^n_{ref} - P^n\\
\dot{e} &= \dot{P}^n_{ref}-\dot{P}^n\\
\ddot{e} &= u_{f_{ref}} - u_f
\end{split}
\end{equation}
Diese kann nach $ u_f $ \DIFdelbegin \DIFdel{um gestellt werden. Damit }\DIFdelend \DIFaddbegin \DIFadd{umgestellt werden. Dadurch }\DIFaddend ergibt sich das nachfolgende Stellgesetz für die Eingangsgröße $ u_f $ des zustandslinearsierenten Systems\DIFaddbegin \DIFadd{, }\DIFaddend welches den Folgefehler ausregelt. 
\begin{equation}
u_f = \underset{Vorsteuerung}{u_{f_{ref}}}+ \underset{Folgeregler}{\tilde{c}_1 \cdot (\dot{P}^n_{ref}-\dot{P}^n) +\tilde{c}_0\cdot (P^n_{ref} - P^n)}
\end{equation}
Die Annäherungsverhalten ist \DIFdelbegin \DIFdel{Abhängig }\DIFdelend \DIFaddbegin \DIFadd{abhängig }\DIFaddend von den Koeffizienten $ \tilde{c}_0 $ und $ \tilde{c}_1 $. Anhand von \ref{eq:fehlerdyn} lassen sich für diese mittels der Polvorgabe (Kapitel \ref{subsec:polvor}) die Dynamik vorgegeben.

Nicht bekämpft werden durch dieses Stellgesetz konstante Dauerstörungen. Hervorgerufen zum Beispiel durch Winde\DIFaddbegin \DIFadd{, }\DIFaddend die über einen längeren Zeitraum als \DIFdelbegin \DIFdel{Konstant }\DIFdelend \DIFaddbegin \DIFadd{konstant }\DIFaddend anzusehen sind. Mit einer konstanten Kraft wirken \DIFdelbegin \DIFdel{diese }\DIFdelend \DIFaddbegin \DIFadd{sie }\DIFaddend auf das Flugsystem. Beachtet man die von dieser Kraft hervorgerufenen Beschleunigungsbeitrag $ a_st $ in der Fehlerdifferenzialgleichung. 
\begin{equation}
\ddot{e} + \tilde{c}_1 \cdot \dot{e}+ \tilde{c}_0\cdot e +a_{st}= 0
\label{eq:fehlerdyn_st}
\end{equation}
Folgt im stationären Zustand, \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{dass }\DIFaddend heißt alle Zeitableitungen gleich Null, ein dauerhafter Positionsfehler.
\begin{equation}
e = -\frac{a_{st}}{\tilde{c}_0}
\end{equation} 
Lösung dieses Problems ist nach \cite{deutNL} die Erweiterung des \DIFdelbegin \DIFdel{Folgeregler mit einer Integrierenden }\DIFdelend \DIFaddbegin \DIFadd{Folgereglers mit einer integrierenden }\DIFaddend Komponente.
\begin{equation}
\ddot{e} + \tilde{c}_1 \cdot \dot{e}+ \tilde{c}_0\cdot e + \underset{I-Anteil}{\tilde{c}_{-1} \int e(\tau)d\tau} +a_{st}= 0
\label{eq:integodif}
\end{equation} 
Der I-Anteil liefert \DIFdelbegin \DIFdel{einen }\DIFdelend \DIFaddbegin \DIFadd{ein }\DIFaddend Signalanteil zur Kompensation der Störung im stationären Zustand. Den Beweis dafür erhält man, wenn man die Integro-Differentialgleichung (\ref{eq:integodif}) nach der Zeit ableitet. Danach ergibt sich \DIFdelbegin \DIFdel{Folgenden }\DIFdelend \DIFaddbegin \DIFadd{folgende }\DIFaddend Differentialgleichung. 
\begin{equation}
	\dddot{e} + \tilde{c}_1 \cdot \ddot{e}+ \tilde{c}_0\cdot \dot{e} + \tilde{c}_{-1} \cdot e = 0
	\label{eq:ifehlerdyn}
\end{equation}
Im eingeschwungenen Zustand \DIFdelbegin \DIFdel{, }\DIFdelend ergibt sich so für den Positionsfehler
\begin{equation}
 e = 0
\end{equation}
Das Stellgesetz für einen Regler mit I-Anteil lässt sich unter Vernachlässigung der Dauerstörung $ a_{st} $ aus Gleichung (\ref{eq:integodif}) entwickeln (vgl. Abbildung \ref{fig:folgeregler}).
\begin{equation}
u_f = \underset{Vorsteuerung}{u_{f_{ref}}}+ \underset{Folgeregler\ inklusive\ I-Anteil}{\tilde{c}_1 \cdot (\dot{P}^n_{ref}-\dot{P}^n) +\tilde{c}_0\cdot (P^n_{ref} - P^n)+\tilde{c}_{-1} \int e(\tau)d\tau}
\label{eq:folgreg_stelgeI}
\end{equation}
\begin{figure}
	\centering
	\includegraphics[width = 0.75\textwidth]{images/folgreg}
	\caption[Folgeregler]{Folgeregler} %
	\label{fig:folgeregler}
\end{figure}
Dieses Stellgesetz führt den Quadrocopter entlang \DIFaddbegin \DIFadd{der }\DIFaddend Referenztrajektorie. Zur erkennen ist dies auch in der Simulation (\ref{fig:folg_RefaliasVor}) mit Regler\DIFdelbegin \DIFdel{Regler}\DIFdelend . So wird für \DIFdelbegin \DIFdel{Inkonsistene }\DIFdelend \DIFaddbegin \DIFadd{inkonsistente }\DIFaddend Anfangsbedingungen (Abbildung \ref{fig:folg_inkonAzust}) das Fluggerät auf die Trajektorie geführt. Für Modellunsicherheiten (Abbildung \ref{fig:folg_unsichmdlpara}) passt der Folgeregler das Stellsignal so an, \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{dass }\DIFaddend der Quadrocopter entlang des vorgegebenen \DIFdelbegin \DIFdel{Pfad }\DIFdelend \DIFaddbegin \DIFadd{Pfades }\DIFaddend fliegt. Vergleich hierzu reine Vorsteuerung (Abbildung \ref{fig:RefaliasVor}).

Wie \DIFdelbegin \DIFdel{auch schon }\DIFdelend zuvor kann das Einschwingverhalten für den Folgeregler mit I-Anteil über die Polvorgabe festgelegt werden. Für diesen \DIFaddbegin \DIFadd{Fall }\DIFaddend ist die Differentialgleichung (\ref{eq:ifehlerdyn}) zu verwenden. 
 \begin{figure}
 	\centering{

 		\subfloat[Inkonsistene Anfangszustände $ p_{ref_0}~=~0~\ne~p_{mdl_0}~=~0.3 $ und $ v_{ref_0}~=~0~\ne~v_{mdl_0}~=~0.2 $, ideales Modell]{
 			\includegraphics[width=0.5\textwidth]{images/p_p0_03_v0_02_Kd_4_Kp_5_Ki_001}
 			\label{fig:folg_inkonAzust}
 		}
 		\subfloat[Unsicherheit der Modellparamter $ m_{inv}=1.863~\ne~m_{mdl}=2.5 $]{
 			\includegraphics[width=0.5\textwidth]{images/p_m_mdl_2_5_Kd_4_Kp_5_Ki_001}
 			\label{fig:folg_unsichmdlpara}
 		}
 	}	
 	\caption[Grafiken Folgeregler]{Auswirkung von Folgeregler ($\tilde{c}_1=4$, $\tilde{c}_0=4$, $\tilde{c}_{-1}=0.01 $) auf inkonsistente Anfangszustände und Modellunsicherheiten }
 	\label{fig:folg_RefaliasVor}
 \end{figure}

 
 %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\subsection{Einstellung der Dynamik mittels Polvorgabe}
\label{subsec:polvor}
Anhand der Lage der Polstellen einer Übertragungsfunktion, \DIFdelbegin \DIFdel{können }\DIFdelend \DIFaddbegin \DIFadd{werden }\DIFaddend Rückschlüsse über die Stabilität und das Einschwingverhalten getroffen\DIFdelbegin \DIFdel{werden}\DIFdelend . Ziel einer Zustandsregelung, wie der \DIFdelbegin \DIFdel{Folgereregelung, ist}\DIFdelend \DIFaddbegin \DIFadd{Folgeregelung ist, }\DIFaddend die Pollagen der zu regelnden Strecke so zu verschieben, dass das \DIFdelbegin \DIFdel{Einausgangsverhalten }\DIFdelend \DIFaddbegin \DIFadd{Ein-/Ausgangsverhalten }\DIFaddend die gewünschte Dynamik aufweist.

Zunächst ist zu klären\DIFaddbegin \DIFadd{, }\DIFaddend was die Polstellenlage in der komplexen Ebene über das Verhalten aussagt. Dabei entspricht die Anzahl der Pole $ \lambda_i $ der Ordnung $ n $ des Systems.
\begin{figure}
	\centering
	\includegraphics[width = 0.75 \textwidth]{images/stabgeb}
	\caption[Stabilitätsgebiet]{Stabilitätsgebiet} %
	\label{fig:stabgeb}
\end{figure}
\begin{itemize}
	\item Befinden sich alle Pole $ \lambda_i $ links der Imaginärachse ($ Re(\lambda_i) < 0 $) \DIFdelbegin \DIFdel{, so }\DIFdelend ist das System asymptotisch stabil, ansonsten instabil (Abbildung \ref{fig:stabgeb}).
	\item Komplexe Pole \DIFdelbegin \DIFdel{können }\DIFdelend \DIFaddbegin \DIFadd{tauchen }\DIFaddend nur in Formen von Polpaaren \DIFdelbegin \DIFdel{auftauchen}\DIFdelend \DIFaddbegin \DIFadd{auf}\DIFaddend . Ist ein \DIFdelbegin \DIFdel{Komplexes }\DIFdelend \DIFaddbegin \DIFadd{komplexes }\DIFaddend Polpaar vorhanden, führt das System nach Anregung eine Schwingung aus. \DIFdelbegin \DIFdel{Befindet }\DIFdelend \DIFaddbegin \DIFadd{Befinden }\DIFaddend sich die Polpaare in der linken Halbebene des Imaginärteil, nimmt die Amplitude der Schwingung exponentiell ab.
	\item Je weiter links sich die Pole auf der reellen Achse befinden, desto schneller ist das System. 
	\item Bei mehreren Polstellen wird das Verhalten hauptsächlich über den Pole bzw. die Polpaare mit dem größten Realteil bestimmt. Sie werden deshalb als dominante Pole bezeichnet.
\end{itemize}
Betrachtet man eine beliebige Übertragungsfunktion im Bildbereich.
\begin{equation}
G_e(s) = \frac{Z(s)}{N(s)}
\label{eq:Ge}
\end{equation}  
Entsprechen die Polstellen $ \lambda_i $ des Systems \DIFdelbegin \DIFdel{, denn }\DIFdelend \DIFaddbegin \DIFadd{den }\DIFaddend Nullstellen $ s_i $ des Nennerpolynom.
\begin{equation}
N(s)=  s^n+c_{n-1} \cdot s^{n-1}+ \cdots + c_1 \cdot s+ c_0 = \prod\limits_{n}^{i=1} (s-\lambda_i)= 0
\label{eq:N}
\end{equation}
Das dynamische Verhalten \DIFdelbegin \DIFdel{kann }\DIFdelend \DIFaddbegin \DIFadd{wird }\DIFaddend anhand dieser Pollage analysiert\DIFdelbegin \DIFdel{werden}\DIFdelend . Im Umkehrschluss \DIFdelbegin \DIFdel{können }\DIFdelend \DIFaddbegin \DIFadd{erfolgt }\DIFaddend für frei wählbare Koeffizienten des Nennerpolynoms die Dynamik über \DIFaddbegin \DIFadd{die }\DIFaddend Vorgabe von Polstellen $ \lambda_{si} $\DIFdelbegin \DIFdel{erfolgen.Dies erfolgt }\DIFdelend \DIFaddbegin \DIFadd{, d.h. }\DIFaddend über einen Koeffizientenvergleich.
\begin{equation}
N(s)=  s^n+c_{n-1} \cdot s^{n-1}+ \cdots + c_1 \cdot s+ c_0 =\prod\limits_{n}^{i=1} (s-\lambda_{si}) 
\end{equation}
Somit ist es möglich\DIFaddbegin \DIFadd{, }\DIFaddend über die Koeffizienten von (\ref{eq:fehlerdyn}) oder (\ref{eq:ifehlerdyn}) das Einschwingverhalten des Folgereglers \DIFdelbegin \DIFdel{mittel }\DIFdelend \DIFaddbegin \DIFadd{mittels }\DIFaddend der Platzierung von Polen vorzugeben. Wie jedoch die Polstellen optimal bestimmt \DIFaddbegin \DIFadd{werden}\DIFaddend , dafür gibt es keine generelle Vorgehensweise. In der Regel werden sie empirisch über Simulationen festgelegt\DIFdelbegin \DIFdel{. Anschließend }\DIFdelend \DIFaddbegin \DIFadd{, anschließend }\DIFaddend am realen Modell getestet und gegebenenfalls optimiert. Diese Optimierung \DIFdelbegin \DIFdel{gesieht }\DIFdelend \DIFaddbegin \DIFadd{geschieht }\DIFaddend meist händisch. \DIFdelbegin \DIFdel{Allerdings gibt es hier }\DIFdelend \DIFaddbegin \DIFadd{Des Weiteren gibt es }\DIFaddend Bemühungen\DIFaddbegin \DIFadd{, }\DIFaddend diese letzte Optimierung am realen System \DIFdelbegin \DIFdel{automatisiert durchzuführen}\DIFdelend \DIFaddbegin \DIFadd{zu automatisieren}\DIFaddend . 

\subsection{Automatische Optimierung der Reglerparameter}
\label{sec:selftun}
In der Simulation ermittelte Parameter müssen \DIFdelbegin \DIFdel{meist }\DIFdelend \DIFaddbegin \DIFadd{häufig }\DIFaddend für das \DIFdelbegin \DIFdel{realen }\DIFdelend \DIFaddbegin \DIFadd{reale }\DIFaddend System leicht angepasst werden. Von Vorteil ist es deshalb, einen Algorithmus zu implementieren, der online und kontinuierlich die Einstellung optimiert. Die Bezeichnung dieses Vorgangs heißt selftuning. 

\DIFdelbegin \DIFdel{Da der }\DIFdelend \DIFaddbegin \DIFadd{Der }\DIFaddend implementierte Folgeregler inklusive I-Anteil \DIFdelbegin \DIFdel{besteht }\DIFdelend \DIFaddbegin \DIFadd{setzt sich }\DIFaddend aus einem Proportionalverstärker $ P $, einem Differentiellen Anteil $ D $ sowie einem Integrationsanteil $ I $ \DIFdelbegin \DIFdel{zusammensetzt}\DIFdelend \DIFaddbegin \DIFadd{zusammen}\DIFaddend .
\begin{equation}
u_f = \underset{Vorsteuerung}{u_{f_{ref}}}+ \underset{D-Anteil}{\tilde{c}_1 \cdot (\dot{P}^n_{ref}-\dot{P}^n)} +\underset{P-Anteil}{\tilde{c}_0\cdot (P^n_{ref} - P^n)}+\underset{I-Anteil}{\tilde{c}_{-1} \int e(\tau)d\tau}
\end{equation}
\DIFdelbegin \DIFdel{Können Tuningalgorithmen angewandtwerden}\DIFdelend \DIFaddbegin \DIFadd{Werden Tuning-Algorithmen angewandt}\DIFaddend , die für einen PID-Regler entwickelt \DIFdelbegin \DIFdel{worden sind. So }\DIFdelend \DIFaddbegin \DIFadd{sind, so }\DIFaddend kann der unter \cite{selftun} vorgestellte Algorithmus angewendet werden. \DIFdelbegin \DIFdel{Dieser tunt }\DIFdelend \DIFaddbegin \DIFadd{Diese tunen }\DIFaddend die Regelparameter über eine adaptive Interaktion\DIFdelbegin \DIFdel{tunt}\DIFdelend . Die Interaktion besteht dabei aus drei Differentialgleichungen zur Anpassung der Koeffizienten des Reglers.
\begin{equation}
\begin{split}
\dot{k}_p &= \dot{\tilde{c}}_0 = \gamma \cdot e^2\\
\dot{k}_i &= \dot{\tilde{c}}_{-1} = \gamma \cdot e \cdot \int e(\tau)d\tau\\
\dot{k}_d &= \dot{\tilde{c}}_1 = \gamma \cdot e\cdot \dot{e}
\end{split}
\end{equation} 

Dabei entspricht $ \gamma $ dem Anpassungskoeffizient. In \cite{selftun} \DIFdelbegin \DIFdel{ist }\DIFdelend \DIFaddbegin \DIFadd{wird }\DIFaddend $ \gamma = 10 $ empfohlen. Die Struktur\DIFaddbegin \DIFadd{, }\DIFaddend des sich daraus ergebenden Folgeregler mit \DIFdelbegin \DIFdel{selbstoptimierung }\DIFdelend \DIFaddbegin \DIFadd{Selbstoptimierung, }\DIFaddend ist in Abbildung dargestellt. 
  \begin{figure}
  	\centering
  	\includegraphics[width = \textwidth]{images/Platzhalter}
  	\caption[Selftuning Folgeregler]{Folgeregler inklusive Selftuning} %
  	\label{fig:selftun00}
  \end{figure}
Anzumerken ist\DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{, dass }\DIFaddend die Qualität der Optimierung \DIFdelbegin \DIFdel{Abhängig }\DIFdelend \DIFaddbegin \DIFadd{abhängig }\DIFaddend von den zu Beginn übergebenen \DIFdelbegin \DIFdel{Parameter ist. Welche }\DIFdelend \DIFaddbegin \DIFadd{Parametern ist. Die }\DIFaddend zuvor zum Beispiel über die Polvorgabe bestimmt \DIFdelbegin \DIFdel{worden sind}\DIFdelend \DIFaddbegin \DIFadd{werden}\DIFaddend . 

\section{Zustandsschätzung}
\label{sec:Zustandsbestimmung}

Bei der Folgeregelung handelt es sich um einen Zustandsregler. 
%Das bedeutet die Werte aller Zustände des realen Systems müssen bekannt sein. 
Betrachtet man das Stellgesetz \ref{eq:folgreg_stelgeI} bedeutet dies, \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{dass die }\DIFaddend Position $ P^n $ und die Geschwindigkeit $ v^n $ mit der sich der Quadrocopter im n-frame bewegt \DIFdelbegin \DIFdel{müssen }\DIFdelend zur Verfügung stehen \DIFaddbegin \DIFadd{müssen}\DIFaddend . Bereits bekannt ist, \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{dass }\DIFaddend die Position $ P^n $ mittels des \DIFdelbegin \DIFdel{Laser }\DIFdelend \DIFaddbegin \DIFadd{Lasers }\DIFaddend (Kapitel \ref{sec:laser_scan_matching}) bestimmt wird. Die Updaterate beträgt dabei nur $ 40 Hz $.
%Die Position $ P^n $ ist bereits über den Laser (Kapitel \ref{chap:2Dpositionsbestimmung}) bestimmt. 
%Besitzt allerdings nur eine Updaterate von $ 40 Hz $.
 \DIFdelbegin \DIFdel{Daher ist es nützlich }\DIFdelend \DIFaddbegin \DIFadd{Es ist sinnvoll }\DIFaddend Zwischenwerte zu schätzen, sodass die Positionsdaten dem Folgeregler in einer höheren Taktrate zur Verfügung stehen. 

 Der Zustand der Geschwindigkeit $ v^n $ ist messtechnisch sehr \DIFdelbegin \DIFdel{schwer }\DIFdelend \DIFaddbegin \DIFadd{komplex }\DIFaddend zu ermitteln. Eine Möglichkeit zur messtechnischen Erfassung \DIFdelbegin \DIFdel{wäre }\DIFdelend \DIFaddbegin \DIFadd{ist }\DIFaddend die Integration eines Dopplerradars \cite{ras12} auf dem Quadrocopter\DIFdelbegin \DIFdel{. Dieser basiert }\DIFdelend \DIFaddbegin \DIFadd{, der }\DIFaddend auf dem Doppler-Effekt \DIFaddbegin \DIFadd{basiert}\DIFaddend . Dabei wird ein periodisches Signal ausgesendet und je nach Geschwindigkeit verkleinert sich \DIFaddbegin \DIFadd{die }\DIFaddend Periodendauer, bzw. vergrößert sich für negative Geschwindigkeiten. So kann anhand der Frequenzänderung des reflektierten Signals auf die Geschwindigkeit geschlossen werden. Diese Umsetzung bedeutet die Integration eines weiteren Sensor. Aus Gewichts- und Kostengründen sind \DIFdelbegin \DIFdel{somit  }\DIFdelend Methoden gefragt, die über die vorhandene Sensorik (IMU und Laser) die Geschwindigkeit des Quadrocopters feststellen.

\subsection{Geschwindigkeitsbestimmung über die Inertialsenorik}
\label{subsec:Vimu}
Die \gls{imu} beinhaltet einen 3D-Bewegungsseonsor. Dieser nimmt die \DIFdelbegin \DIFdel{auf }\DIFdelend Beschleunigung in x, y und z- Achse des Quadrocopters auf und stellt die Messwerte mit einer Frequenz von 1kHz ($ T_{imu}=1ms $) zur Verfügung. Aufgrund des Weg-Zeit-Gesetzes (\ref{eq:weg-zeit}) lässt sich die Geschwindigkeit über die Integration der Beschleunigung bestimmen. Für den diskreten Fall lässt sich diese mittels des \DIFdelbegin \DIFdel{Eulerverfahren }\DIFdelend \DIFaddbegin \DIFadd{Euler-Verfahrens }\DIFaddend approximieren. Zuvor \DIFdelbegin \DIFdel{müssen die Beschleunigungsmesswerte jedoch }\DIFdelend \DIFaddbegin \DIFadd{werden die Beschleunigungsmesswerte }\DIFaddend ins n-frame \DIFdelbegin \DIFdel{Transformiert }\DIFdelend \DIFaddbegin \DIFadd{transformiert }\DIFaddend (Gleichung (\ref{eq:inverse_transM}))\DIFdelbegin \DIFdel{werden}\DIFdelend .  
\begin{equation}
v^n_{k+1} = v^n_k + T_{imu} \cdot (M_{nb}\cdot a^b_k) = v^n_k + T \cdot a^n_k 
\end{equation}
\DIFdelbegin \DIFdel{Somit }\DIFdelend \DIFaddbegin \DIFadd{Auf diese Weise }\DIFaddend ist die Geschwindigkeit bestimmt. In der Praxis führt diese Methode allerdings zu keinem \DIFdelbegin \DIFdel{gutem }\DIFdelend \DIFaddbegin \DIFadd{guten }\DIFaddend Ergebnis. Grund dafür ist das Sensorrauschen $ r_{a_k} $ sowie der Bias b, der trotz Initialisierung nicht vollständig zu \DIFdelbegin \DIFdel{eliminiert ist. Somit ist }\DIFdelend \DIFaddbegin \DIFadd{eliminieren ist. Damit entspricht }\DIFaddend der Messwert $ a^b_k $ nicht der tatsächlichen Beschleunigung $ a^b_{k_{tat}} $.
\begin{equation}
a^b_k = a^b_{k_{tat}} +  r_{a_k}+b
\end{equation}  
Das Problem \DIFaddbegin \DIFadd{ist}\DIFaddend , der Fehler wird mit \DIFdelbegin \DIFdel{Integriert}\DIFdelend \DIFaddbegin \DIFadd{integriert}\DIFaddend . Damit driften geschätzte und \DIFdelbegin \DIFdel{reelen }\DIFdelend \DIFaddbegin \DIFadd{reale }\DIFaddend Geschwindigkeit auseinander. \DIFdelbegin \DIFdel{Somit }\DIFdelend \DIFaddbegin \DIFadd{Dadurch }\DIFaddend ist eine Geschwindigkeitsbestimmung ausschließlich über die Inertialsensorik \DIFdelbegin \DIFdel{nicht }\DIFdelend möglich. 

\subsection{Geschwindigkeit als Ableitung der Position}
\label{subsec:abpos}
Ebenfalls auf Basis des Weg-Zeit-Gesetzes (\ref{eq:weg-zeit}) \DIFdelbegin \DIFdel{lässt }\DIFdelend \DIFaddbegin \DIFadd{bestimmt }\DIFaddend sich die Geschwindigkeit über die Ableitung der Quadrocopterpositionen\DIFdelbegin \DIFdel{bestimmen}\DIFdelend .
%lässt sich die Geschwindigkeit aufgrund des Weg-Zeit-Gesetzes (\ref{eq:weg-zeit}) über Ableitung der Quadrocopterpositionen bestimmen. 
Da es \DIFaddbegin \DIFadd{sich }\DIFaddend bei den Positionsdaten um diskrete Werte handelt, lässt sich die Ableitung  anhand des Euler-Verfahren \DIFaddbegin \DIFadd{s}\DIFaddend (\ref{eq:eul}) approximieren.
\begin{equation}
P^n_k=P^n_{k-1}+T_l \cdot v^n_k 
\label{eq:eul}
\end{equation}
Für die Geschwindigkeit ergibt sich
\DIFdelbegin \DIFdel{so
}\DIFdelend \begin{equation}
v^n_k = \frac{P^n_k-P^n_{k-1}}{T_l}
\label{eq:v_eul}
\end{equation}
Die Abtastzeit $ T_l = 25ms $ ($f_l = 40Hz $). \DIFdelbegin \DIFdel{Diese }\DIFdelend \DIFaddbegin \DIFadd{Sie }\DIFaddend entspricht der Updaterate  der Umgebungsscans des Lasers mit denen die Algorithmen zur Positionsbestimmung gespeist werden. Bei der Approximation der Geschwindigkeit ist zu beachten, dass das Positionssignal aufgrund von Sensorrauschen von Laser und Gyroskope sowie der Varianz des \gls{icp}-Algorithmus eine Abweichung vom tatsächlichen Positionswert $ P^n_{k_{tat}} $ aufweist. Diese Abweichung ist nicht konstant und ist als Positionsrauschen$ r_{P_k} $ darzustellen. 
\begin{equation}
P^n_k = P^n_{k_{tat}}+r_{P_k}
\end{equation}
Dieses Positonsrauschen $ r_P $ überträgt sich auf die Geschwindigkeit. 
\begin{equation}
v^n_k = \frac{P^n_k-P^n_{k-1}}{T_l} + \frac{r_{P_k} -r_{P_{k-1}}}{T_l}
\label{eq:vn_diskabrau}
\end{equation} 
 Diese führt \DIFdelbegin \DIFdel{jedoch }\DIFdelend nicht dazu, das wie bei der Geschwindigkeitsbestimmung mittels der Beschleunigungssensoren, \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{dass }\DIFaddend Schätzwert und Realwert auseinander \DIFdelbegin \DIFdel{divergiert. Nichtsdestotrotz hat }\DIFdelend \DIFaddbegin \DIFadd{divergieren. Nichtsdestotrotz besitzt }\DIFaddend das Rauschen einen Einfluss auf die Qualität der Geschwindigkeitsberechnung. So fällt bei niedrigen Geschwindigkeiten der Abstand zwischen zwei Positionswerten geringer aus. Der Betrag des Rauschanteils \DIFdelbegin \DIFdel{jedoch }\DIFdelend bleibt konstant. Dies führt vor allem bei Schwebeflügen sowie Flügen mit geringer Dynamik zu einer erhöhten Unsicherheit der Schätzung (Abbildung \ref{fig:VarPosVerschHohe}). Zwar zeigt \DIFdelbegin \DIFdel{Grafik \ref{fig:VarPosVerschNierdrig} das }\DIFdelend \DIFaddbegin \DIFadd{die Grafik \ref{fig:VarPosVerschNierdrig}, dass }\DIFaddend der Einfluss des Rauschen auf die Varianz der errechneten Geschwindigkeit (\ref{eq:vn_diskabrau}) mit der Größe der Positionsverschiebung abnimmt. Ungeachtet dessen ist es \DIFdelbegin \DIFdel{jedoch notwendig gerade }\DIFdelend \DIFaddbegin \DIFadd{gerade notwendig }\DIFaddend für Bewegungen \DIFdelbegin \DIFdel{mir }\DIFdelend \DIFaddbegin \DIFadd{mit }\DIFaddend geringer Geschwindigkeit den Einfluss des Positionsrauschens zu minimieren.  
 \begin{figure}
 	\centering{
 		\subfloat[Keine/kleine Positionsverschiebung, hohe Varianz]{
 			\includegraphics[width=0.4\textwidth]{images/hoheVar}
 			\label{fig:VarPosVerschHohe}
 		}
 		\hspace{0.1\textwidth}
 		\subfloat[Große Positionsverschiebung, geringe Varianz]{
 			\includegraphics[width=0.4\textwidth]{images/kleineVar}
 			\label{fig:VarPosVerschNierdrig}
 		}
 	}	
 	\caption[Auswirkung der Positionsverschiebung auf Varianz der Geschwindigkeit]{Auswirkung der Größe der Positionsverschiebung innerhalb eines Schätzwertes auf die Varianz der Geschwindigkeitsschätzung}
 	\label{fig:VarPosVersch}
 \end{figure}
 Geht man davon aus, \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{dass }\DIFaddend die Frequenz des Rauschanteils oberhalb des Frequenzbades der Positionsänderungen liegt\DIFdelbegin \DIFdel{. Kann }\DIFdelend \DIFaddbegin \DIFadd{, kann }\DIFaddend das Nutzsignal mittels eines Tiefpassfilters vom Rauschanteil getrennt werden. Das Tiefpassfilter lässt sich dabei mittels eines rekursiven \gls{iir}-Filters realisieren \cite{des14}. Die gefilterte Geschwindigkeit $ \hat{v}^n_k $ hängt dabei nicht nur von \DIFaddbegin \DIFadd{den }\DIFaddend vorherigen Messwerten $v^n_k $\DIFaddbegin \DIFadd{, }\DIFaddend sondern auch von den vorherigen Filterergebnissen \DIFaddbegin \DIFadd{ab}\DIFaddend .
 \begin{equation}
 \hat{v}^n_k = \sum\limits_{j = 0}^{n}a_j \cdot v^n_{k-j}+ \sum\limits_{i = 1}^{n}b_j \cdot \hat{v}^n_{k-i}
 \label{eq:filter}
 \end{equation}
 Mittels der Koeffizienten $ a_j $ und $ b_i $ \DIFdelbegin \DIFdel{kann nun }\DIFdelend \DIFaddbegin \DIFadd{wird }\DIFaddend das gewünschte Filterverhalten, zum Beispiel das eines Butterworth-Filters, mit der benötigten Grenzfrequenz realisiert\DIFdelbegin \DIFdel{werden}\DIFdelend . Die Ordnung $ n $ des Filter beschreibt wie viele der vorangegangenen Messwerten in die Filterung mit einzubeziehen sind. Beim Design des Filters \DIFdelbegin \DIFdel{müssen }\DIFdelend \DIFaddbegin \DIFadd{werden }\DIFaddend jedoch Kompromisse zwischen Zeitverzögerung, Phasenverzerrung, Dämpfung und Stoppbandeigenschaften getroffen\DIFdelbegin \DIFdel{werden}\DIFdelend . Für die Folgeregelung ist es dabei \DIFdelbegin \DIFdel{Wichtig, das die beiden erste genannten }\DIFdelend \DIFaddbegin \DIFadd{wichtig, dass die beiden erstgenannten }\DIFaddend Kriterien möglichst gering ausfallen. Ist dies nicht der Fall, wirkt es destabilisierend auf den Regler. 

 Des \DIFdelbegin \DIFdel{weiteren }\DIFdelend \DIFaddbegin \DIFadd{Weiteren }\DIFaddend lassen sich Aufgrund der \DIFdelbegin \DIFdel{geringe }\DIFdelend \DIFaddbegin \DIFadd{geringen }\DIFaddend Updaterate von $ 40 Hz $ der Positionsdaten, die Dynamik des Quadrocopters und das Positionsrauschen \DIFdelbegin \DIFdel{Spektral nicht von einander trennen. Möchte man also das Positionsrauschenunterdrücken}\DIFdelend \DIFaddbegin \DIFadd{spektral nicht voneinander trennen. Unterdrückt man das Positionsrauschen}\DIFaddend , werden auch schnelle Positionsänderungen des Quadrocoptes weg gefiltert. Für die hohe Dynamik des Quadrocopters ist die Anwendung eines Tiefpassfilter mit Grenzfrequenz nicht \DIFdelbegin \DIFdel{möglich}\DIFdelend \DIFaddbegin \DIFadd{gangbar}\DIFaddend . Gesucht ist \DIFdelbegin \DIFdel{nun }\DIFdelend eine Methode, die für Flüge mit geringer Dynamik die Varianz der Geschwindigkeitsschätzung\DIFaddbegin \DIFadd{, }\DIFaddend verursacht durch Positionsrauschen\DIFaddbegin \DIFadd{, }\DIFaddend möglichst stark \DIFdelbegin \DIFdel{verringert}\DIFdelend \DIFaddbegin \DIFadd{verringern}\DIFaddend . Gleichzeitig jedoch der \DIFdelbegin \DIFdel{Hohen }\DIFdelend \DIFaddbegin \DIFadd{hohen }\DIFaddend Dynamik des Quadrocopters folge leisten kann.  

 \subsection{Geschwindigkeitsbestimmung über die Methode First-Order Adaptive Windowing }
 \label{subsec:adaptwind}
 (Hier fehlt 1kHz und Position\DIFaddbegin \DIFadd{, }\DIFaddend zwar höhrer Abtastrate verfügbar, Fehler \DIFdelbegin \DIFdel{drifftet }\DIFdelend \DIFaddbegin \DIFadd{driftet }\DIFaddend durch doppelte Integration zu schnell zu weit weg)
 Wie \DIFdelbegin \DIFdel{schon }\DIFdelend in Kaptiel \ref{subsec:abpos} \DIFdelbegin \DIFdel{erkannt}\DIFdelend \DIFaddbegin \DIFadd{erläutert}\DIFaddend , nimmt die Varianz der Geschwindigkeitsschätzung ab\DIFaddbegin \DIFadd{, }\DIFaddend je weiter die Positionswerte auseinander liegen. Hierfür \DIFdelbegin \DIFdel{sei }\DIFdelend \DIFaddbegin \DIFadd{der Hinweis }\DIFaddend auf Grafik \ref{fig:VarPosVerschNierdrig}\DIFdelbegin \DIFdel{verwiesen}\DIFdelend . Der gleiche Effekt tritt auf, je mehr Abtastschritte $ n $ der für die \DIFdelbegin \DIFdel{Eulerapproximation verwendete Bezugspunkt }\DIFdelend \DIFaddbegin \DIFadd{Euler-Approximation verwendete Bezugspunkte }\DIFaddend $ P^n_{k-n} $ in der Vergangenheit \DIFdelbegin \DIFdel{liegt}\DIFdelend \DIFaddbegin \DIFadd{liegen}\DIFaddend . 
 \begin{equation}
 \hat{v}^n_k = \frac{P^n_k-P^n_{k-n}}{nT_l}=
 \label{eq:v_eul_n}
 \end{equation}
 Dabei ist die Verwendung der Bezugsposition $ P^n_{k-n} $ gleichzusetzen mit der Mittlung der letzten $ n $ Geschwindigkeitsschätzungen ($ v^n_k,v^n_{k-1},\cdots,v^n_{k-1} $) mittels (\ref{eq:v_eul}). Deshalb spricht man auch von Fensterung beziehungsweise Windowing. Siehe zur Veranschaulichung Abbildung~\ref{fig:Fensterung}. Vergrößert man das Fenster\DIFdelbegin \DIFdel{hat }\DIFdelend \DIFaddbegin \DIFadd{, besitzt }\DIFaddend das eine äquivalente Wirkung wie die Reduzierung der Abtastrate.
  \begin{figure}
  	\centering
  	\includegraphics[width = \textwidth]{images/wind_avg}
  	\caption[Fensterung]{Fensterung} %
  	\label{fig:Fensterung}
  \end{figure}
 Das Windowing verhält sich wie ein Filter. So führt ein großes Fenster bei geringen Dynamiken zu einer sehr präzisen Geschwindigkeitsschätzung durch Rauschunterdrückung. Schätzungen für \DIFdelbegin \DIFdel{Hochfrequenter }\DIFdelend \DIFaddbegin \DIFadd{hochfrequente }\DIFaddend Bewegungen des Quadrocopter werden jedoch stark gedämpft und \DIFdelbegin \DIFdel{Zeitverzögert }\DIFdelend \DIFaddbegin \DIFadd{zeitverzögert }\DIFaddend ausgegeben, womit die Verlässlichkeit der Schätzung abnimmt. Es wirkt \DIFdelbegin \DIFdel{somit }\DIFdelend ähnlich wie das Filter (\ref{eq:filter}). Allerdings mit dem Vorteil, \DIFaddbegin \DIFadd{dass }\DIFaddend das Filterverhalten nur über \DIFdelbegin \DIFdel{eine }\DIFdelend \DIFaddbegin \DIFadd{einen }\DIFaddend Parameter einstellbar ist\DIFdelbegin \DIFdel{. Der }\DIFdelend \DIFaddbegin \DIFadd{, der }\DIFaddend Fenstergröße $ n $. So sollte das Window klein sein, wenn der Quadrocopter \DIFdelbegin \DIFdel{Hochfrequente }\DIFdelend \DIFaddbegin \DIFadd{hochfrequente }\DIFaddend Änderungen der Bewegung vornimmt, damit die abrupten Geschwindigkeitsänderungen möglichst ungedämpft erfasst werden. Bei geringen Dynamiken soll die Fenstergröße \DIFdelbegin \DIFdel{jedoch }\DIFdelend \DIFaddbegin \DIFadd{dennoch }\DIFaddend zunehmen, wodurch der Einfluss des Positionsrauschens minimiert werden soll. 
   \begin{figure}
   	\centering
   	\includegraphics[width = \textwidth]{images/End-fit-foaw}
   	\caption[End-fit \gls{foaw}]{End-fit \gls{foaw}} %
   	\label{fig:foaw}
   \end{figure}
 Dabei \DIFdelbegin \DIFdel{muss }\DIFdelend \DIFaddbegin \DIFadd{erfolgt }\DIFaddend die Anpassung der Fenstergröße online und für jeden Punkt \DIFdelbegin \DIFdel{Abhängig }\DIFdelend \DIFaddbegin \DIFadd{abhängig }\DIFaddend der Achse des n-frame\DIFdelbegin \DIFdel{separat erfolgen}\DIFdelend . Im Paper \cite{adaptWin} wird dafür die Methode des \gls{foaw} vorgestellt. Diese \DIFdelbegin \DIFdel{Besagt}\DIFdelend \DIFaddbegin \DIFadd{besagt}\DIFaddend , existiert eine Grade zwischen den Positionswerten $ p^n_k $ und $ p^n_{k-n} $ einer Achse, die alle $ n $ Punkte innerhalb einer Tolerenz $ \pm d $ schneidet, stellt die Steigung dieser und somit die Geschwindigkeit einen optimalen Kompromiss zwischen Rauschunterdrückung (Präzision) und Verlässlichkeit dar. Die möglichen Schätzwerte für die Geschwindigkeit\DIFaddbegin \DIFadd{, }\DIFaddend abhängig von der Fenstergröße $ n $ und der Toleranz $ d $\DIFaddbegin \DIFadd{, }\DIFaddend sind im folgenden Datensatz dargestellt.

 \begin{equation}
 \hat{v}_k \in [\frac{p^n_k-p^n_{k-n}}{n T_l}-\frac{2d}{n T_l}, \frac{p^n_k-p^n_{k-n}}{n T_l}-\frac{2d}{n T_l}]
 \end{equation}
  Die Toleranz $ d $ ist dabei durch den Betrag der maximalen Rauschabweichung festgelegt und \DIFdelbegin \DIFdel{somit }\DIFdelend als Konstante zu sehen.
 \begin{equation}
 d = ||r_{max}||
 \end{equation}
Zu erkennen ist, \DIFdelbegin \DIFdel{das }\DIFdelend \DIFaddbegin \DIFadd{dass }\DIFaddend die Varianz der Schätzung für eine steigende Fenstergröße $ n $ abnimmt. Somit ist ausgehend von der aktuellen Position $ p^n_k $ die maximale mögliche Fenstergröße $ n = max\{1,2,3,\dots\} $ zu ermitteln\DIFaddbegin \DIFadd{, }\DIFaddend für die gilt,
\begin{equation}
|p^n_{k-i} - \hat{p}^n_{k-i}|\le d \hspace{1.5cm}\forall i \in \{1,2,\dots,n\}
\label{eq:toleranz}
\end{equation} 
Dabei entspricht $ \hat{p}^n_{k-i} $ den \DIFdelbegin \DIFdel{Punkte }\DIFdelend \DIFaddbegin \DIFadd{Punkten }\DIFaddend auf der approximierenden Geradengleichung.
\begin{equation}
\hat{p}^n_{k-i} = a_n + b_n \cdot(k-i) T_l
\label{eq:gradengl}
\end{equation}
In \cite{adaptWin} ist dazu ein iterativer Algorithmus zur Lösung dieses Problems beschrieben. Dabei sind die Parameter der Geradengleichung (\ref{eq:gradengl}) wie folgt parametriert.
\begin{equation}
a_n =\frac{k \cdot p^n_{k-i} + (n-k)p^n_{k}}{n}
\label{eq:a_n}
\end{equation}
\begin{equation}
b_n =\frac{p^n_{k} - p^n_{k-n}}{n T_l}
\label{eq:b_n}
\end{equation}



Da die Steigung $ b_n $ aus den zwei Rändern des Fensters gebildet wird, spricht man von der End-fit-\gls{foaw}.  


Der Ablauf \DIFdelbegin \DIFdel{der des Interationsalgorithmus sieht dann }\DIFdelend \DIFaddbegin \DIFadd{des Interations-Algorithmus sieht }\DIFaddend wie folgt aus.

\begin{itemize}
	\item \textbf{Schritt 1:} Man verschiebt die Zeitachse so, dass für den Zeitpunkt des neusten \DIFdelbegin \DIFdel{Wert }\DIFdelend \DIFaddbegin \DIFadd{Wertes }\DIFaddend $ p^n_k $ gilt $ t_k = k\cdot T_l = 0 $. Die Folge ist eine vom Faktor $ k $ unabhängige Geradengleichung.
	\begin{equation}
	\hat{p}^n_{k-i} = a_n + b_n \cdot(-i) \cdot T_l
	\label{eq:gradengl_t0}
	\end{equation}
	Für die gilt,
	 \begin{equation}
	a_n = p^n_k
	\end{equation}
	und $ b_n  $ weiterhin über (\ref{eq:a_n}) berechnet \DIFdelbegin \DIFdel{werden kann}\DIFdelend \DIFaddbegin \DIFadd{wird}\DIFaddend . Vorteil, es muss jeweils nur die Steigung neu berechnet werden.
	\item \textbf{Schritt 2:} Fenstergröße j = 1.
	\item \textbf{Schritt \DIFdelbegin \DIFdel{2}\DIFdelend \DIFaddbegin \DIFadd{3}\DIFaddend :} Berechnung des Parameters $b_j $ (\ref{eq:b_n}) der Geradengleichung (\ref{eq:gradengl_t0}) in Abhängigkeit der Fenstergröße $ j $.
	\item \textbf{Schritt \DIFdelbegin \DIFdel{3}\DIFdelend \DIFaddbegin \DIFadd{4}\DIFaddend :} Überprüfen ob die berechnete Gerade alle im Fester befindlichen Punkte $p^n_{k-i} i \in \{1,2,\dots,j\} $ innerhalb  der Toleranz passiert. Bedingung (\ref{eq:toleranz}) 
	\item \textbf{Schritt \DIFdelbegin \DIFdel{4}\DIFdelend \DIFaddbegin \DIFadd{5}\DIFaddend :} Ist Schritt \DIFdelbegin \DIFdel{3 }\DIFdelend \DIFaddbegin \DIFadd{4 }\DIFaddend erfüllt, inkrementiere die Fenstergröße $ j =j+1 $ und gehe zu Schritt 2. Wenn Bedingung nicht erfüllt \DIFaddbegin \DIFadd{ist}\DIFaddend , ist die Steigung der vorhergegangen Geradengleichung als Schätzwert der Geschwindigkeit auszugeben. 
	\begin{equation}
	 \hat{v}_k = b_{j-1}=b_n
	\end{equation} 
	Die maximale Fenstergröße $ n $ entspricht für Position $ p^n_{k} $  \DIFdelbegin \DIFdel{somit }\DIFdelend \DIFaddbegin \DIFadd{mit }\DIFaddend $ n = j-1 $ 
\end{itemize} 

 Dieser Vorgang wird für \DIFdelbegin \DIFdel{jeden }\DIFdelend \DIFaddbegin \DIFadd{jede }\DIFaddend Aktualisierung  $ k = k+1 $ des Positionswert $ p^n_{k} $ neu gestartet. Zur Veranschaulichung ist der Algorithmus noch einmal in einen Flussdiagramm (Abbildung \ref{fig:flussfoaw}) dargestellt.  

 \begin{figure}
 	\centering
 	\includegraphics[width = \textwidth]{images/Platzhalter}
 	\caption[Flussdiagramm \gls{foaw}]{Flussdiagramm \gls{foaw}} %
 	\label{fig:flussfoaw}
 \end{figure}
 Die End-fit-\gls{foaw} verwendet für den Schätzvorgang die zwei Endpunkte des Fensters. In \cite{adaptWin} wird deshalb \DIFdelbegin \DIFdel{noch }\DIFdelend die Best-fit\gls{foaw} vorgestellt. Dabei wird die Steigung \DIFdelbegin \DIFdel{, }\DIFdelend über die Methode\DIFaddbegin \DIFadd{, }\DIFaddend der des kleinsten quadratischen Fehler\DIFaddbegin \DIFadd{, }\DIFaddend bestimmt. Das bedeutet für die zeitnormierte Geradengleichung ist eine Steigung $ b_n $ gesucht\DIFaddbegin \DIFadd{, }\DIFaddend für die die Summe der Fehlerquadrat $ e^2 $ ein Minimum aufweist.  
 \begin{equation}
 e_{min}^2 = min \sum\limits_{i=0}^{n}(p^n_{k-i} - \hat{p}^n_{k-i})^2
 \label{eq:quade}
 \end{equation}
 mit
 \begin{equation}
\hat{p}^n_{k-i} = p^n_{k} - b_n \cdot i \cdot T_l 
 \end{equation}
Um das Minimum der Fehlergleichung (\ref{eq:quade}) in Abhängigkeit der Steigung bestimmen zu können, \DIFdelbegin \DIFdel{muss }\DIFdelend \DIFaddbegin \DIFadd{ist }\DIFaddend diese nach $ b_n $ abzuleiten. Da es sich um eine quadratische Gleichung handelt, weist der Fehler \DIFdelbegin \DIFdel{Tiefpunkt auf}\DIFdelend \DIFaddbegin \DIFadd{Tiefpunkte auf, }\DIFaddend wenn diese Ableitung Null ergibt.
\begin{equation}
\frac{d e^2}{d b_n}=0
\end{equation}
Löst man unter dieser Bedingung die Ableitung nach $ b_n $ auf. Erhält man die Steigung die die Summe der kleinsten quadratischen Fehler aufweist.
\begin{equation}
b_n = \frac{(n\sum\limits_{ i=0}^{n}y_{k-1}-2\sum\limits_{i=0}^{n} i\cdot y_{k-1})\cdot 6 }{T_l n(n+1)(n+2)}
\end{equation}
Nun ist die Steigung allgemeingültig für variable Fenstergrößen bestimmt. Die Umsetzung der best-fit-\gls{foaw} in der Software erfolgt nach dem gleichen Schema wie bei der end-fit-\gls{foaw}. Einziger Unterschied, zur Berechnung der Steigung $ b_n $ wir die Gleichung verwendet. Das \DIFdelbegin \DIFdel{Ergbnis }\DIFdelend \DIFaddbegin \DIFadd{Ergebnis }\DIFaddend ist eine präzisere Schätzung bei gleichbleibender Zuverlässigkeit der Messung. Beide Methoden sind \DIFdelbegin \DIFdel{jedoch }\DIFdelend anfällig gegen sogenannte Outliner. Einzelne Signalwerte\DIFdelbegin \DIFdel{die eine }\DIFdelend \DIFaddbegin \DIFadd{, die einen }\DIFaddend höheren Fehler als die maximale durch das Rauschen verursachte Abweichung $ d $ aufweisen. Outliner lassen sich \DIFdelbegin \DIFdel{jedoch }\DIFdelend sehr einfach durch \DIFdelbegin \DIFdel{eine robuster }\DIFdelend \DIFaddbegin \DIFadd{ein robustes }\DIFaddend Abbruchkriterium in Schritt \DIFdelbegin \DIFdel{3 }\DIFdelend \DIFaddbegin \DIFadd{4 }\DIFaddend bekämpfen. So gilt die Bedingung (\ref{eq:toleranz}) erst dann für nicht \DIFdelbegin \DIFdel{bestimmt}\DIFdelend \DIFaddbegin \DIFadd{bestimmbar}\DIFaddend , wenn zwei aufeinanderfolgende Werte das \DIFdelbegin \DIFdel{Kriterum }\DIFdelend \DIFaddbegin \DIFadd{Kriterium }\DIFaddend nicht erfüllen. Erst \DIFdelbegin \DIFdel{dann }\DIFdelend \DIFaddbegin \DIFadd{dadurch }\DIFaddend wird die Vergrößerung des Fensters gestoppt. Diese Variante nennt sich best-fit-\gls{foaw}-R.
 \begin{figure}

 	\centering{
 		\subfloat[Positionsignal]{
 			\includegraphics[width=0.5\textwidth]{images/adap_position}
 			\label{fig:adapt_pos}
 		}
 		\subfloat[Ableitung (Kapitel \ref{subsec:abpos}) vs. endfit-\gls{foaw}]{
 			\includegraphics[width=0.5\textwidth]{images/adap_dtvsendfit}
 			\label{fig:adapt_ablvsend}
 		}\\
 		\subfloat[endfit-\gls{foaw} vs. bestfit-\gls{foaw}]{
 			\includegraphics[width=0.5\textwidth]{images/adap_endfitvsbestfit}
 			\label{fig:adapt_endvsbest}
 		}
 		\subfloat[bestfit-\gls{foaw} vs. bestfit-R-\gls{foaw}]{
 			\includegraphics[width=0.5\textwidth]{images/adap_bestfitvsbestfitr}
 			\label{fig:adapt_bestvsbestr}
 		}
 		}

 	\caption[Messergebnis für \gls{foaw}]{Vergleich der Filterergebnisse für \gls{foaw}}
 	\label{fig:adap_vergleich}
 \end{figure}



Die Methoden des \gls{foaw} \DIFdelbegin \DIFdel{bietet eine sehr }\DIFdelend \DIFaddbegin \DIFadd{bieten eine sehr gute }\DIFaddend Möglichkeit die Geschwindigkeit auf Basis eines verrauschten \DIFdelbegin \DIFdel{Positionssignal }\DIFdelend \DIFaddbegin \DIFadd{Positionssignals }\DIFaddend zu ermitteln. Problematisch ist \DIFdelbegin \DIFdel{jedoch }\DIFdelend \DIFaddbegin \DIFadd{allerdings }\DIFaddend die geringe Abtastrate von $ 40 Hz $ des Lasers. Schon bei Flügen \DIFdelbegin \DIFdel{bei }\DIFdelend \DIFaddbegin \DIFadd{mit }\DIFaddend mittlerer Dynamik führt \DIFdelbegin \DIFdel{dies dazu, das }\DIFdelend \DIFaddbegin \DIFadd{das dazu, dass }\DIFaddend die Fenstergröße stark reduziert wird. Somit auch der Einfluss des Positionsrauschens stark zunimmt. \DIFdelbegin \DIFdel{Somit kann selbst diese Konzept}\DIFdelend \DIFaddbegin \DIFadd{Als Folge kann selbst dieses Konzept, }\DIFaddend limitiert durch die Tastrate des Lasers\DIFaddbegin \DIFadd{, }\DIFaddend der Dynamik des Quadrocopters nicht \DIFdelbegin \DIFdel{nachkommen}\DIFdelend \DIFaddbegin \DIFadd{folgen}\DIFaddend . Es ist \DIFdelbegin \DIFdel{somit klardas }\DIFdelend \DIFaddbegin \DIFadd{klar, dass }\DIFaddend eine Methode benötigt wird, die \DIFdelbegin \DIFdel{Position und }\DIFdelend \DIFaddbegin \DIFadd{die Position und die }\DIFaddend Geschwindigkeit in einer \DIFdelbegin \DIFdel{höhren }\DIFdelend \DIFaddbegin \DIFadd{höheren }\DIFaddend Taktrate zur Verfügung stellt. Gleichzeit müssen beide Signale ausreichend \DIFdelbegin \DIFdel{Rauschunterdrückt }\DIFdelend \DIFaddbegin \DIFadd{rauschunterdrückt }\DIFaddend sein. 

 \subsection{Bestimmung der Zustände mittels eines Fusionsfilter}
 \label{subsec:Fusionsfilter}
 Wie aus den \DIFdelbegin \DIFdel{oberen Kapitel zuerkenne }\DIFdelend \DIFaddbegin \DIFadd{vorherigen Kapitel erkennbar, }\DIFaddend wird keine der Methoden \DIFdelbegin \DIFdel{den }\DIFdelend \DIFaddbegin \DIFadd{der }\DIFaddend zuvor gestellten Ansprüche gerecht. So erfüllt die Integration der Beschleunigung (Kapitel \ref{subsec:Vimu}) zwar das Kriterium zur Erhöhung der Taktrate \DIFdelbegin \DIFdel{. }\DIFdelend \DIFaddbegin \DIFadd{und }\DIFaddend Beschleunigungsmesswerte werden in einem Takt von $ 1 kHz $ zur Verfügung gestellt. \DIFdelbegin \DIFdel{Doch }\DIFdelend \DIFaddbegin \DIFadd{Allerdings }\DIFaddend durch den Bias des Beschleunigungssensors \DIFdelbegin \DIFdel{, }\DIFdelend divergieren innerhalb kürzester Zeit die geschätzten Zustände von den realen Zuständen. Dieses Phänomen tritt bei den Anwendungen \DIFdelbegin \DIFdel{Kaptiel und Kapitel}\DIFdelend \DIFaddbegin \DIFadd{Kapitel?? und Kapitel?? }\DIFaddend nicht auf. Der Grund, sie beziehen sich auf die vom Laser berechneten Positionswerte. Die Abweichungen dieser Zustandswerte befinden sich dabei in einem konstanten Rahmen um die tatsächliche Position. \DIFdelbegin \DIFdel{Diese }\DIFdelend \DIFaddbegin \DIFadd{Dieses }\DIFaddend Positionsrauschen sorgt bei der Geschwindigkeitsschätzung über die Ableitung der Positionswerte dafür, dass das errechnete Geschwindigkeitssignal ebenfalls einen Rauschanteil aufweist. Diesen Rauschanteil zu minimieren ist Ziel der \gls{foaw} Methode. Aufgrund der geringen Abtastfrequenz von $ 40Hz  $ kann dieser Ansatz der hohen Dynamik nicht \DIFdelbegin \DIFdel{folge }\DIFdelend \DIFaddbegin \DIFadd{Folge }\DIFaddend leisten. Schon für \DIFdelbegin \DIFdel{geringen }\DIFdelend \DIFaddbegin \DIFadd{geringe }\DIFaddend Dynamiken ist die Fenstergröße stark dezimiert und \DIFdelbegin \DIFdel{somit }\DIFdelend \DIFaddbegin \DIFadd{damit }\DIFaddend auch die Rauschunterdrückung. Das Ergebnis, \DIFdelbegin \DIFdel{Bechleunigungssensor }\DIFdelend \DIFaddbegin \DIFadd{Beschleunigungssensor }\DIFaddend der \gls{imu} und Laser \DIFaddbegin \DIFadd{bieten }\DIFaddend jeweils für sich \DIFdelbegin \DIFdel{bieten }\DIFdelend keine ausreichende Zustandswerte. Abhilfe \DIFdelbegin \DIFdel{, }\DIFdelend \DIFaddbegin \DIFadd{generiert die }\DIFaddend Fusion beider Sensordaten mittels eines Fusionsfilters. Dabei sorgen die Beschleunigungswerte mit ihrer hohen \DIFdelbegin \DIFdel{update Rate }\DIFdelend \DIFaddbegin \DIFadd{update-Rate }\DIFaddend von $ 1 Khz $ für eine schnelle Reaktionsfähigkeit und tragen somit der Dynamik des Quadrocopters sorge. Die Positionsdaten des Laser indes verhindern ein Abdriften der Schätzwerte. Somit stellen sie die Zuverlässigkeit der Fusionsergebnisse sicher. 

Das auf dem \gls{hlp} implementierte Fusionsfilter basiert auf einem Leunberger Beobachter\cite{Achtelik11}. Dieser besteht aus einen linearen Streckenmodell dessen Zustände $ \hat{x} $ mittels eines Korrekturterms ($ L\cdot (y-\hat{y})$) auf die Zustände $ x $ der Regelstrecke einschwingen. Die Zustandsdifferenzialgleichung eines Luenberger Beobachter stellt sich in allgemeiner Form  \cite{regB12} wie folgt dar.
\begin{equation}
\begin{split}
\dot{\hat{x}} &= A \cdot \hat{x}+ L \cdot (y-\hat{y}) + B \cdot u\\
\hat{y} &= C \cdot \hat{x}
\end{split}
\label{eq:algbeo}
\end{equation} 
Dabei entspricht $ A $ der Dynamikmatrix, $ B $ dem Eingangsmatrix und $ C $ dem Ausgangsmatrix des linearen Streckenmodells. Aufgrund der Inversion, ist das Bewegungsmodell für jede Achse im n-frame, als Integrationsglied 2.Ordnung gegeben (Abbildung \ref{fig:drIntket}). Dabei entspricht die Eingangsgrößen $ u $ den ins n-frame transformierten Beschleunigungswerten der \gls{imu}. Da die Ketten entkoppelt sind, muss der Beobachter nicht für alle drei Ketten gleichzeitig entworfen werden. Somit ist es ausreichen eine Integrationsglied 2.Ordnung als Streckenmodell heranzuziehen. Weiterhin ist bekannt, das die Beschleunigungswerte der \gls{imu} einen Bias aufweisen. Nach \cite{mzr13} kann das Streckenmodell deshalb wie in Abbildung \ref{emod} erweitert werden. 
   \begin{figure}
   	\centering
   	\includegraphics[width = \textwidth]{images/erwModell}
   	\caption[Erweitertes Streckenmodell]{Erweitertes Streckenmodell} %
   	\label{fig:emod}
   \end{figure}
Dieses erweiterte Modell ist über Zustandsdifferenzialgleichung (\ref{eq:emod}) beschreiben
\begin{equation}
\begin{split}
\dot{x} &= \underset{A}{\begin{bmatrix} 
	0&	1&	0\\
	0&  0&  1\\
	0&	0&  0
	\end{bmatrix}} \cdot x+ \underset{B}{\begin{bmatrix}
	0\\
	1\\
	0
	\end{bmatrix}} \cdot u\\
y &= \underset{C}{\begin{bmatrix}
	1& 0& 0
	\end{bmatrix}} \cdot x
\end{split}
\label{eq:emod}
\end{equation} 
mit,
\begin{equation}
\hat{x} = \begin{bmatrix}
p^n&	v^n& 	b
\end{bmatrix}^T
\end{equation}
Anhand von (\ref{eq:algbeo}) folgt daraus für den Beobachter.
\begin{equation}
\begin{split}
\dot{\hat{x}} &= \underset{A}{\begin{bmatrix} 
	0&	1&	0\\
	0&  0&  1\\
	0&	0&  0
	\end{bmatrix}} \cdot \hat{x}+ \underset{L}{\begin{bmatrix}
	l_1\\
	l_2\\
	l_3
	\end{bmatrix}} \cdot (y-\hat{y}) + \underset{B}{\begin{bmatrix}
	0\\
	1\\
	0
	\end{bmatrix}} \cdot u\\
\hat{y} &= \underset{C}{\begin{bmatrix}
	1& 0& 0
	\end{bmatrix}} \cdot \hat{x}
\end{split}
\end{equation} 
mit,
\begin{equation}
\hat{x} = \begin{bmatrix}
\hat{p}^n&	\hat{v}^n& 	\hat{b}
\end{bmatrix}^T
\end{equation}
Die Elemente der Beobachtermartix $ L $ sind so zu parametrieren das die Fehlerdynamik das gewünschte Einschwingverhalten aufweist. Da der Zustandsfehler $ \tilde{x} = x-\hat{x} $ gilt, ergibt sich für die Dynamik des Zustandsfehlers
\begin{equation}
\dot{\tilde{x}}=\dot{x}-\dot{\hat{x}}=(A-LC)\cdot \tilde{x}
\end{equation}
Um diese mittels Polvorgabe einstellen zu können, muss charakteristische Polynom gebildet werden \cite{regB12}.
\begin{equation} 
N(s)=\det(A-LC)
\end{equation}
ergibt für das erweitere Zustandsmodell,
\begin{equation} 
N(s)=s^3+l_1\cdot s^2+l_2 \cdot s + l_3
\end{equation}
Anhand dieses Polynom sind Koeffizienten der Beobachtermatrix $ L $ nach Kapitel \ref{subsec:polvor} über Polvorgabe vorgebbar. 
  \begin{figure}
  	\centering
  	\includegraphics[width = \textwidth]{images/Platzhalter}
  	\caption[Beobachter]{Strukturbild Beobachter} %
  	\label{fig:strucB}
  \end{figure}

 \begin{figure}

 	\centering{
 		\subfloat[Einspeisung]{
 			\includegraphics[width=0.5\textwidth]{images/ua}
 			\label{fig:bo_ua}
 		}
 		\subfloat[Einschwingverhalten Bias]{
 			\includegraphics[width=0.5\textwidth]{images/bias}
 			\label{fig:bo_bias}
 		}\\
 			\subfloat[Beschleunigung]{
 				\includegraphics[width=0.5\textwidth]{images/beschl}
 				\label{fig:bo_beschl}
 			}
 			\subfloat[Geschwindigkeit]{
 				\includegraphics[width=0.5\textwidth]{images/geschw}
 				\label{fig:bo_geschw}
 			}\\
 			\subfloat[Position]{
 				\includegraphics[width=0.5\textwidth]{images/Position}
 				\label{fig:bo_pos}
 			}
 		}	
 	\caption[Simulation Beobachter]{Simulationsergebnisse für das Fusionsfilter}
 	\label{fig:bo_sim}
 \end{figure}

  \begin{figure}

  	\centering{
  		\subfloat[Positionsignal]{
  			\includegraphics[width=0.5\textwidth]{images/adap_position}
  			\label{fig:bo_adapt_pos}
  		}
  		\subfloat[Ableitung (Kapitel \ref{subsec:abpos}) vs. Beobachter]{
  			\includegraphics[width=0.5\textwidth]{images/obs_vxvsob}
  			\label{fig:bo_dvdtvsbo}
  		}
  	}	
  	\caption[Verbesserung des Fusionsfilter im Vergleich \gls{foaw}]{Verbesserung des Fusionsfilter im Vergleich \gls{foaw}}
  	\label{fig:bo_sim}
  \end{figure} 
 